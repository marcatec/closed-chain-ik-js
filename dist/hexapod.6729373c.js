function e(e,t,n,i){Object.defineProperty(e,t,{get:n,set:i,enumerable:!0,configurable:!0})}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},i={},o=t.parcelRequireafd0;null==o&&((o=function(e){if(e in n)return n[e].exports;if(e in i){var t=i[e];delete i[e];var o={id:e,exports:{}};return n[e]=o,t.call(o.exports,o,o.exports),o.exports}var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,t){i[e]=t},t.parcelRequireafd0=o),o.register("8C12l",(function(t,n){e(t.exports,"default",(()=>f));var i=o("ilwiq"),s=o("Q6arU"),r=o("aXdpk"),a=o("3iDF4");const c=new i.Quaternion,l=new i.Euler;function u(e){return e?e.trim().split(/\s+/g).map((e=>parseFloat(e))):[0,0,0]}function d(e,t,n=!1){n||e.rotation.set(0,0,0),l.set(t[0],t[1],t[2],"ZYX"),c.setFromEuler(l),c.multiply(e.quaternion),e.quaternion.copy(c)}class f{constructor(e){this.manager=e||i.DefaultLoadingManager,this.loadMeshCb=this.defaultMeshLoader.bind(this),this.parseVisual=!0,this.parseCollision=!1,this.packages="",this.workingPath="",this.fetchOptions={}}loadAsync(e){return new Promise(((t,n)=>{this.load(e,t,null,n)}))}load(e,t,n,o){const s=this.manager,r=i.LoaderUtils.extractUrlBase(e),a=this.manager.resolveURL(e);s.itemStart(a),fetch(a,this.fetchOptions).then((e=>{if(e.ok)return n&&n(null),e.text();throw new Error(`URDFLoader: Failed to load url '${a}' with error code ${e.status} : ${e.statusText}.`)})).then((e=>{""===this.workingPath&&(this.workingPath=r);const n=this.parse(e);t(n),s.itemEnd(a)})).catch((e=>{o?o(e):console.error("URDFLoader: Error loading file.",e),s.itemError(a),s.itemEnd(a)}))}parse(e){const t=this.packages,n=this.loadMeshCb,o=this.parseVisual,s=this.parseCollision,r=this.workingPath,c=this.manager,l={},f={},h={};function m(e){if(!/^package:\/\//.test(e))return r?r+e:e;const[n,i]=e.replace(/^package:\/\//,"").split(/\/(.+)/);return"string"==typeof t?t.endsWith(n)?t+"/"+i:t+"/"+n+"/"+i:t instanceof Function?t(n)+"/"+i:"object"==typeof t?n in t?t[n]+"/"+i:(console.error(`URDFLoader : ${n} not found in provided package list.`),null):void 0}function p(e){const t=[...e.children],n=new i.MeshPhongMaterial;return n.name=e.getAttribute("name")||"",t.forEach((e=>{const t=e.nodeName.toLowerCase();if("color"===t){const t=e.getAttribute("rgba").split(/\s/g).map((e=>parseFloat(e)));n.color.setRGB(t[0],t[1],t[2]),n.opacity=t[3],n.transparent=t[3]<1,n.depthWrite=!n.transparent}else if("texture"===t){const t=e.getAttribute("filename");if(t){const e=new i.TextureLoader(c),o=m(t);n.map=e.load(o)}}})),n}function g(e,t={}){const o="collision"===e.nodeName.toLowerCase(),s=[...e.children];let r=null;const l=s.filter((e=>"material"===e.nodeName.toLowerCase()))[0];if(l){const e=l.getAttribute("name");r=e&&e in t?t[e]:p(l)}else r=new i.MeshPhongMaterial;const f=o?new a.URDFCollider:new a.URDFVisual;return f.urdfNode=e,s.forEach((e=>{const t=e.nodeName.toLowerCase();if("geometry"===t){const t=e.children[0].nodeName.toLowerCase();if("mesh"===t){const t=m(e.children[0].getAttribute("filename"));if(null!==t){const o=e.children[0].getAttribute("scale");if(o){const e=u(o);f.scale.set(e[0],e[1],e[2])}n(t,c,((e,t)=>{t?console.error("URDFLoader: Error loading mesh.",t):e&&(e instanceof i.Mesh&&(e.material=r),e.position.set(0,0,0),e.quaternion.identity(),f.add(e))}))}}else if("box"===t){const t=new i.Mesh;t.geometry=new i.BoxBufferGeometry(1,1,1),t.material=r;const n=u(e.children[0].getAttribute("size"));t.scale.set(n[0],n[1],n[2]),f.add(t)}else if("sphere"===t){const t=new i.Mesh;t.geometry=new i.SphereBufferGeometry(1,30,30),t.material=r;const n=parseFloat(e.children[0].getAttribute("radius"))||0;t.scale.set(n,n,n),f.add(t)}else if("cylinder"===t){const t=new i.Mesh;t.geometry=new i.CylinderBufferGeometry(1,1,1,30),t.material=r;const n=parseFloat(e.children[0].getAttribute("radius"))||0,o=parseFloat(e.children[0].getAttribute("length"))||0;t.scale.set(n,o,n),t.rotation.set(Math.PI/2,0,0),f.add(t)}}else if("origin"===t){const t=u(e.getAttribute("xyz")),n=u(e.getAttribute("rpy"));f.position.set(t[0],t[1],t[2]),f.rotation.set(0,0,0),d(f,n)}})),f}return function(e){let t;if(e instanceof Document)t=[...e.children];else if(e instanceof Element)t=[e];else{t=[...(new DOMParser).parseFromString(e,"text/xml").children]}return function(e){const t=[...e.children],n=t.filter((e=>"link"===e.nodeName.toLowerCase())),r=t.filter((e=>"joint"===e.nodeName.toLowerCase())),c=t.filter((e=>"material"===e.nodeName.toLowerCase())),m=new a.URDFRobot;m.robotName=e.getAttribute("name"),m.urdfRobotNode=e,c.forEach((e=>{const t=e.getAttribute("name");h[t]=p(e)}));const b={},y={};n.forEach((t=>{const n=t.getAttribute("name"),i=null===e.querySelector(`child[link="${n}"]`);l[n]=function(e,t,n,i=null){null===i&&(i=new a.URDFLink);const r=[...e.children];if(i.name=e.getAttribute("name"),i.urdfName=i.name,i.urdfNode=e,o){r.filter((e=>"visual"===e.nodeName.toLowerCase())).forEach((e=>{const n=g(e,h);if(i.add(n),e.hasAttribute("name")){const i=e.getAttribute("name");n.name=i,n.urdfName=i,t[i]=n}}))}if(s){r.filter((e=>"collision"===e.nodeName.toLowerCase())).forEach((e=>{const t=g(e);if(i.add(t),e.hasAttribute("name")){const i=e.getAttribute("name");t.name=i,t.urdfName=i,n[i]=t}}))}return i}(t,b,y,i?m:null)})),r.forEach((e=>{const t=e.getAttribute("name");f[t]=function(e){const t=[...e.children],n=e.getAttribute("type");let o;const s=t.find((e=>"mimic"===e.nodeName.toLowerCase()));s?(o=new a.URDFMimicJoint,o.mimicJoint=s.getAttribute("joint"),o.multiplier=parseFloat(s.getAttribute("multiplier")||1),o.offset=parseFloat(s.getAttribute("offset")||0)):o=new a.URDFJoint;o.urdfNode=e,o.name=e.getAttribute("name"),o.urdfName=o.name,o.jointType=n;let r=null,c=null,f=[0,0,0],h=[0,0,0];t.forEach((e=>{const t=e.nodeName.toLowerCase();"origin"===t?(f=u(e.getAttribute("xyz")),h=u(e.getAttribute("rpy"))):"child"===t?c=l[e.getAttribute("link")]:"parent"===t?r=l[e.getAttribute("link")]:"limit"===t&&(o.limit.lower=parseFloat(e.getAttribute("lower")||o.limit.lower),o.limit.upper=parseFloat(e.getAttribute("upper")||o.limit.upper))})),r.add(o),o.add(c),d(o,h),o.position.set(f[0],f[1],f[2]);const m=t.filter((e=>"axis"===e.nodeName.toLowerCase()))[0];if(m){const e=m.getAttribute("xyz").split(/\s+/g).map((e=>parseFloat(e)));o.axis=new i.Vector3(e[0],e[1],e[2]),o.axis.normalize()}return o}(e)})),m.joints=f,m.links=l,m.colliders=y,m.visual=b;const w=Object.values(f);return w.forEach((e=>{e instanceof a.URDFMimicJoint&&f[e.mimicJoint].mimicJoints.push(e)})),w.forEach((e=>{const t=new Set,n=e=>{if(t.has(e))throw new Error("URDFLoader: Detected an infinite loop of mimic joints.");t.add(e),e.mimicJoints.forEach((e=>{n(e)}))};n(e)})),m.frames={...y,...b,...l,...f},m}(t.filter((e=>"robot"===e.nodeName)).pop())}(e)}defaultMeshLoader(e,t,n){if(/\.stl$/i.test(e)){new s.STLLoader(t).load(e,(e=>{const t=new i.Mesh(e,new i.MeshPhongMaterial);n(t)}))}else if(/\.dae$/i.test(e)){new r.ColladaLoader(t).load(e,(e=>n(e.scene)))}else console.warn(`URDFLoader: Could not load model at ${e}.\nNo loader available`)}}})),o.register("Q6arU",(function(t,n){e(t.exports,"STLLoader",(()=>s));var i=o("ilwiq");class s extends i.Loader{constructor(e){super(e)}load(e,t,n,o){const s=this,r=new i.FileLoader(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,(function(n){try{t(s.parse(n))}catch(t){o?o(t):console.error(t),s.manager.itemError(e)}}),n,o)}parse(e){function t(e,t,n){for(let i=0,o=e.length;i<o;i++)if(e[i]!==t.getUint8(n+i))return!1;return!0}const n=function(e){if("string"==typeof e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=255&e.charCodeAt(n);return t.buffer||t}return e}(e);return function(e){const n=new DataView(e);if(84+50*n.getUint32(80,!0)===n.byteLength)return!0;const i=[115,111,108,105,100];for(let e=0;e<5;e++)if(t(i,n,e))return!1;return!0}(n)?function(e){const t=new DataView(e),n=t.getUint32(80,!0);let o,s,r,a,c,l,u,d,f=!1;for(let e=0;e<70;e++)1129270351==t.getUint32(e,!1)&&82==t.getUint8(e+4)&&61==t.getUint8(e+5)&&(f=!0,a=new Float32Array(9*n),c=t.getUint8(e+6)/255,l=t.getUint8(e+7)/255,u=t.getUint8(e+8)/255,d=t.getUint8(e+9)/255);const h=new i.BufferGeometry,m=new Float32Array(9*n),p=new Float32Array(9*n);for(let e=0;e<n;e++){const n=84+50*e,i=t.getFloat32(n,!0),d=t.getFloat32(n+4,!0),h=t.getFloat32(n+8,!0);if(f){const e=t.getUint16(n+48,!0);0==(32768&e)?(o=(31&e)/31,s=(e>>5&31)/31,r=(e>>10&31)/31):(o=c,s=l,r=u)}for(let c=1;c<=3;c++){const l=n+12*c,u=9*e+3*(c-1);m[u]=t.getFloat32(l,!0),m[u+1]=t.getFloat32(l+4,!0),m[u+2]=t.getFloat32(l+8,!0),p[u]=i,p[u+1]=d,p[u+2]=h,f&&(a[u]=o,a[u+1]=s,a[u+2]=r)}}return h.setAttribute("position",new i.BufferAttribute(m,3)),h.setAttribute("normal",new i.BufferAttribute(p,3)),f&&(h.setAttribute("color",new i.BufferAttribute(a,3)),h.hasColors=!0,h.alpha=d),h}(n):function(e){const t=new i.BufferGeometry,n=/solid([\s\S]*?)endsolid/g,o=/facet([\s\S]*?)endfacet/g;let s=0;const r=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,a=new RegExp("vertex"+r+r+r,"g"),c=new RegExp("normal"+r+r+r,"g"),l=[],u=[],d=new i.Vector3;let f,h=0,m=0,p=0;for(;null!==(f=n.exec(e));){m=p;const e=f[0];for(;null!==(f=o.exec(e));){let e=0,t=0;const n=f[0];for(;null!==(f=c.exec(n));)d.x=parseFloat(f[1]),d.y=parseFloat(f[2]),d.z=parseFloat(f[3]),t++;for(;null!==(f=a.exec(n));)l.push(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3])),u.push(d.x,d.y,d.z),e++,p++;1!==t&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+s),3!==e&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+s),s++}const n=m,i=p-m;t.addGroup(n,i,h),h++}return t.setAttribute("position",new i.Float32BufferAttribute(l,3)),t.setAttribute("normal",new i.Float32BufferAttribute(u,3)),t}("string"!=typeof(o=e)?i.LoaderUtils.decodeText(new Uint8Array(o)):o);var o}}})),o.register("aXdpk",(function(t,n){e(t.exports,"ColladaLoader",(()=>r));var i=o("ilwiq"),s=o("iVtfO");class r extends i.Loader{constructor(e){super(e)}load(e,t,n,o){const s=this,r=""===s.path?i.LoaderUtils.extractUrlBase(e):s.path,a=new i.FileLoader(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,(function(n){try{t(s.parse(n,r))}catch(t){o?o(t):console.error(t),s.manager.itemError(e)}}),n,o)}parse(e,t){function n(e,t){const n=[],i=e.childNodes;for(let e=0,o=i.length;e<o;e++){const o=i[e];o.nodeName===t&&n.push(o)}return n}function o(e){if(0===e.length)return[];const t=e.trim().split(/\s+/),n=new Array(t.length);for(let e=0,i=t.length;e<i;e++)n[e]=t[e];return n}function r(e){if(0===e.length)return[];const t=e.trim().split(/\s+/),n=new Array(t.length);for(let e=0,i=t.length;e<i;e++)n[e]=parseFloat(t[e]);return n}function a(e){if(0===e.length)return[];const t=e.trim().split(/\s+/),n=new Array(t.length);for(let e=0,i=t.length;e<i;e++)n[e]=parseInt(t[e]);return n}function c(e){return e.substring(1)}function l(e){return 0===Object.keys(e).length}function u(e){return void 0!==e&&!0===e.hasAttribute("meter")?parseFloat(e.getAttribute("meter")):1}function d(e){return void 0!==e?e.textContent:"Y_UP"}function f(e,t,i,o){const s=n(e,t)[0];if(void 0!==s){const e=n(s,i);for(let t=0;t<e.length;t++)o(e[t])}}function h(e,t){for(const n in e){e[n].build=t(e[n])}}function m(e,t){return void 0!==e.build||(e.build=t(e)),e.build}function p(e){const t={inputs:{}};for(let n=0,i=e.childNodes.length;n<i;n++){const i=e.childNodes[n];if(1===i.nodeType&&"input"===i.nodeName){const e=c(i.getAttribute("source")),n=i.getAttribute("semantic");t.inputs[n]=e}}return t}function g(e){const t={};let n=e.getAttribute("target").split("/");const i=n.shift();let o=n.shift();const s=-1!==o.indexOf("("),r=-1!==o.indexOf(".");if(r)n=o.split("."),o=n.shift(),t.member=n.shift();else if(s){const e=o.split("(");o=e.shift();for(let t=0;t<e.length;t++)e[t]=parseInt(e[t].replace(/\)/,""));t.indices=e}return t.id=i,t.sid=o,t.arraySyntax=s,t.memberSyntax=r,t.sampler=c(e.getAttribute("source")),t}function b(e){const t=[],n=e.channels,i=e.samplers,o=e.sources;for(const e in n)if(n.hasOwnProperty(e)){const s=n[e],r=i[s.sampler],a=r.inputs.INPUT,c=r.inputs.OUTPUT;k(w(s,o[a],o[c]),t)}return t}function y(e){return m(Ye.animations[e],b)}function w(e,t,n){const i=Ye.nodes[e.id],o=qe(i.id),s=i.transforms[e.sid],r=i.matrix.clone().transpose();let a,c,l,u,d,f;const h={};switch(s){case"matrix":for(l=0,u=t.array.length;l<u;l++)if(a=t.array[l],c=l*n.stride,void 0===h[a]&&(h[a]={}),!0===e.arraySyntax){const t=n.array[c],i=e.indices[0]+4*e.indices[1];h[a][i]=t}else for(d=0,f=n.stride;d<f;d++)h[a][d]=n.array[c+d];break;case"translate":case"rotate":case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',s)}const m=function(e,t){const n=[];for(const t in e)n.push({time:parseFloat(t),value:e[t]});n.sort(i);for(let e=0;e<16;e++)T(n,e,t.elements[e]);function i(e,t){return e.time-t.time}return n}(h,r);return{name:o.uuid,keyframes:m}}const N=new i.Vector3,x=new i.Vector3,A=new i.Quaternion;function k(e,t){const n=e.keyframes,o=e.name,s=[],r=[],a=[],c=[];for(let e=0,t=n.length;e<t;e++){const t=n[e],i=t.time,o=t.value;Ce.fromArray(o).transpose(),Ce.decompose(N,A,x),s.push(i),r.push(N.x,N.y,N.z),a.push(A.x,A.y,A.z,A.w),c.push(x.x,x.y,x.z)}return r.length>0&&t.push(new i.VectorKeyframeTrack(o+".position",s,r)),a.length>0&&t.push(new i.QuaternionKeyframeTrack(o+".quaternion",s,a)),c.length>0&&t.push(new i.VectorKeyframeTrack(o+".scale",s,c)),t}function T(e,t,n){let i,o,s,r=!0;for(o=0,s=e.length;o<s;o++)i=e[o],void 0===i.value[t]?i.value[t]=null:r=!1;if(!0===r)for(o=0,s=e.length;o<s;o++)i=e[o],i.value[t]=n;else!function(e,t){let n,i;for(let o=0,s=e.length;o<s;o++){const s=e[o];if(null===s.value[t]){if(n=v(e,o,t),i=E(e,o,t),null===n){s.value[t]=i.value[t];continue}if(null===i){s.value[t]=n.value[t];continue}C(s,n,i,t)}}}(e,t)}function v(e,t,n){for(;t>=0;){const i=e[t];if(null!==i.value[n])return i;t--}return null}function E(e,t,n){for(;t<e.length;){const i=e[t];if(null!==i.value[n])return i;t++}return null}function C(e,t,n,i){n.time-t.time!=0?e.value[i]=(e.time-t.time)*(n.value[i]-t.value[i])/(n.time-t.time)+t.value[i]:e.value[i]=t.value[i]}function R(e){const t=[],n=e.name,o=e.end-e.start||-1,s=e.animations;for(let e=0,n=s.length;e<n;e++){const n=y(s[e]);for(let e=0,i=n.length;e<i;e++)t.push(n[e])}return new i.AnimationClip(n,o,t)}function L(e){return m(Ye.clips[e],R)}function _(e){const t={sources:{}};for(let n=0,i=e.childNodes.length;n<i;n++){const i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"bind_shape_matrix":t.bindShapeMatrix=r(i.textContent);break;case"source":const e=i.getAttribute("id");t.sources[e]=ae(i);break;case"joints":t.joints=F(i);break;case"vertex_weights":t.vertexWeights=U(i)}}return t}function F(e){const t={inputs:{}};for(let n=0,i=e.childNodes.length;n<i;n++){const i=e.childNodes[n];if(1===i.nodeType&&"input"===i.nodeName){const e=i.getAttribute("semantic"),n=c(i.getAttribute("source"));t.inputs[e]=n}}return t}function U(e){const t={inputs:{}};for(let n=0,i=e.childNodes.length;n<i;n++){const i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"input":const e=i.getAttribute("semantic"),n=c(i.getAttribute("source")),o=parseInt(i.getAttribute("offset"));t.inputs[e]={id:n,offset:o};break;case"vcount":t.vcount=a(i.textContent);break;case"v":t.v=a(i.textContent)}}return t}function M(e){const t={id:e.id},n=Ye.geometries[t.id];return void 0!==e.skin&&(t.skin=function(e){const t=4,n={joints:[],indices:{array:[],stride:t},weights:{array:[],stride:t}},o=e.sources,s=e.vertexWeights,r=s.vcount,a=s.v,c=s.inputs.JOINT.offset,l=s.inputs.WEIGHT.offset,u=e.sources[e.joints.inputs.JOINT],d=e.sources[e.joints.inputs.INV_BIND_MATRIX],f=o[s.inputs.WEIGHT.id].array;let h,m,p,g=0;for(h=0,p=r.length;h<p;h++){const e=r[h],i=[];for(m=0;m<e;m++){const e=a[g+c],t=f[a[g+l]];i.push({index:e,weight:t}),g+=2}for(i.sort(b),m=0;m<t;m++){const e=i[m];void 0!==e?(n.indices.array.push(e.index),n.weights.array.push(e.weight)):(n.indices.array.push(0),n.weights.array.push(0))}}e.bindShapeMatrix?n.bindMatrix=(new i.Matrix4).fromArray(e.bindShapeMatrix).transpose():n.bindMatrix=(new i.Matrix4).identity();for(h=0,p=u.array.length;h<p;h++){const e=u.array[h],t=(new i.Matrix4).fromArray(d.array,h*d.stride).transpose();n.joints.push({name:e,boneInverse:t})}function b(e,t){return t.weight-e.weight}return n}(e.skin),n.sources.skinIndices=t.skin.indices,n.sources.skinWeights=t.skin.weights),t}function j(e){return void 0!==e.build?e.build:e.init_from}function D(e){const t=Ye.images[e];return void 0!==t?m(t,j):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",e),null)}function V(e){const t={surfaces:{},samplers:{}};for(let n=0,i=e.childNodes.length;n<i;n++){const i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"newparam":O(i,t);break;case"technique":t.technique=I(i);break;case"extra":t.extra=z(i)}}return t}function O(e,t){const n=e.getAttribute("sid");for(let i=0,o=e.childNodes.length;i<o;i++){const o=e.childNodes[i];if(1===o.nodeType)switch(o.nodeName){case"surface":t.surfaces[n]=q(o);break;case"sampler2D":t.samplers[n]=S(o)}}}function q(e){const t={};for(let n=0,i=e.childNodes.length;n<i;n++){const i=e.childNodes[n];if(1===i.nodeType&&"init_from"===i.nodeName)t.init_from=i.textContent}return t}function S(e){const t={};for(let n=0,i=e.childNodes.length;n<i;n++){const i=e.childNodes[n];if(1===i.nodeType&&"source"===i.nodeName)t.source=i.textContent}return t}function I(e){const t={};for(let n=0,i=e.childNodes.length;n<i;n++){const i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"constant":case"lambert":case"blinn":case"phong":t.type=i.nodeName,t.parameters=B(i);break;case"extra":t.extra=z(i)}}return t}function B(e){const t={};for(let n=0,i=e.childNodes.length;n<i;n++){const i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":t[i.nodeName]=J(i);break;case"transparent":t[i.nodeName]={opaque:i.hasAttribute("opaque")?i.getAttribute("opaque"):"A_ONE",data:J(i)}}}return t}function J(e){const t={};for(let n=0,i=e.childNodes.length;n<i;n++){const i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"color":t[i.nodeName]=r(i.textContent);break;case"float":t[i.nodeName]=parseFloat(i.textContent);break;case"texture":t[i.nodeName]={id:i.getAttribute("texture"),extra:P(i)}}}return t}function P(e){const t={technique:{}};for(let n=0,i=e.childNodes.length;n<i;n++){const i=e.childNodes[n];if(1===i.nodeType&&"extra"===i.nodeName)H(i,t)}return t}function H(e,t){for(let n=0,i=e.childNodes.length;n<i;n++){const i=e.childNodes[n];if(1===i.nodeType&&"technique"===i.nodeName)G(i,t)}}function G(e,t){for(let n=0,i=e.childNodes.length;n<i;n++){const i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":t.technique[i.nodeName]=parseFloat(i.textContent);break;case"wrapU":case"wrapV":"TRUE"===i.textContent.toUpperCase()?t.technique[i.nodeName]=1:"FALSE"===i.textContent.toUpperCase()?t.technique[i.nodeName]=0:t.technique[i.nodeName]=parseInt(i.textContent);break;case"bump":t[i.nodeName]=Q(i)}}}function z(e){const t={};for(let n=0,i=e.childNodes.length;n<i;n++){const i=e.childNodes[n];if(1===i.nodeType&&"technique"===i.nodeName)t.technique=W(i)}return t}function W(e){const t={};for(let n=0,i=e.childNodes.length;n<i;n++){const i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"double_sided":t[i.nodeName]=parseInt(i.textContent);break;case"bump":t[i.nodeName]=Q(i)}}return t}function Q(e){const t={};for(let n=0,i=e.childNodes.length;n<i;n++){const i=e.childNodes[n];if(1===i.nodeType&&"texture"===i.nodeName)t[i.nodeName]={id:i.getAttribute("texture"),texcoord:i.getAttribute("texcoord"),extra:P(i)}}return t}function X(e){return e}function $(e){const t=(n=e.url,m(Ye.effects[n],X));var n;const o=t.profile.technique;let s;switch(o.type){case"phong":case"blinn":s=new i.MeshPhongMaterial;break;case"lambert":s=new i.MeshLambertMaterial;break;default:s=new i.MeshBasicMaterial}function r(e,n=null){const o=t.profile.samplers[e.id];let s=null;if(void 0!==o){s=D(t.profile.surfaces[o.source].init_from)}else console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),s=D(e.id);if(null!==s){const t=function(e){let t,n=e.slice(2+(e.lastIndexOf(".")-1>>>0));n=n.toLowerCase(),t="tga"===n?Qe:We;return t}(s);if(void 0!==t){const o=t.load(s),r=e.extra;if(void 0!==r&&void 0!==r.technique&&!1===l(r.technique)){const e=r.technique;o.wrapS=e.wrapU?i.RepeatWrapping:i.ClampToEdgeWrapping,o.wrapT=e.wrapV?i.RepeatWrapping:i.ClampToEdgeWrapping,o.offset.set(e.offsetU||0,e.offsetV||0),o.repeat.set(e.repeatU||1,e.repeatV||1)}else o.wrapS=i.RepeatWrapping,o.wrapT=i.RepeatWrapping;return null!==n&&(o.encoding=n),o}return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",s),null}return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",e.id),null}s.name=e.name||"";const a=o.parameters;for(const e in a){const t=a[e];switch(e){case"diffuse":t.color&&s.color.fromArray(t.color),t.texture&&(s.map=r(t.texture,i.sRGBEncoding));break;case"specular":t.color&&s.specular&&s.specular.fromArray(t.color),t.texture&&(s.specularMap=r(t.texture));break;case"bump":t.texture&&(s.normalMap=r(t.texture));break;case"ambient":t.texture&&(s.lightMap=r(t.texture,i.sRGBEncoding));break;case"shininess":t.float&&s.shininess&&(s.shininess=t.float);break;case"emission":t.color&&s.emissive&&s.emissive.fromArray(t.color),t.texture&&(s.emissiveMap=r(t.texture,i.sRGBEncoding))}}s.color.convertSRGBToLinear(),s.specular&&s.specular.convertSRGBToLinear(),s.emissive&&s.emissive.convertSRGBToLinear();let c=a.transparent,u=a.transparency;if(void 0===u&&c&&(u={float:1}),void 0===c&&u&&(c={opaque:"A_ONE",data:{color:[1,1,1,1]}}),c&&u)if(c.data.texture)s.transparent=!0;else{const e=c.data.color;switch(c.opaque){case"A_ONE":s.opacity=e[3]*u.float;break;case"RGB_ZERO":s.opacity=1-e[0]*u.float;break;case"A_ZERO":s.opacity=1-e[3]*u.float;break;case"RGB_ONE":s.opacity=e[0]*u.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',c.opaque)}s.opacity<1&&(s.transparent=!0)}if(void 0!==o.extra&&void 0!==o.extra.technique){const e=o.extra.technique;for(const t in e){const n=e[t];switch(t){case"double_sided":s.side=1===n?i.DoubleSide:i.FrontSide;break;case"bump":s.normalMap=r(n.texture),s.normalScale=new i.Vector2(1,1)}}}return s}function K(e){return m(Ye.materials[e],$)}function Z(e){for(let t=0;t<e.childNodes.length;t++){const n=e.childNodes[t];if("technique_common"===n.nodeName)return Y(n)}return{}}function Y(e){const t={};for(let n=0;n<e.childNodes.length;n++){const i=e.childNodes[n];switch(i.nodeName){case"perspective":case"orthographic":t.technique=i.nodeName,t.parameters=ee(i)}}return t}function ee(e){const t={};for(let n=0;n<e.childNodes.length;n++){const i=e.childNodes[n];switch(i.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":t[i.nodeName]=parseFloat(i.textContent)}}return t}function te(e){let t;switch(e.optics.technique){case"perspective":t=new i.PerspectiveCamera(e.optics.parameters.yfov,e.optics.parameters.aspect_ratio,e.optics.parameters.znear,e.optics.parameters.zfar);break;case"orthographic":let n=e.optics.parameters.ymag,o=e.optics.parameters.xmag;const s=e.optics.parameters.aspect_ratio;o=void 0===o?n*s:o,n=void 0===n?o/s:n,o*=.5,n*=.5,t=new i.OrthographicCamera(-o,o,n,-n,e.optics.parameters.znear,e.optics.parameters.zfar);break;default:t=new i.PerspectiveCamera}return t.name=e.name||"",t}function ne(e){const t=Ye.cameras[e];return void 0!==t?m(t,te):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",e),null)}function ie(e){const t={};for(let n=0,i=e.childNodes.length;n<i;n++){const i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"directional":case"point":case"spot":case"ambient":t.technique=i.nodeName,t.parameters=oe(i)}}return t}function oe(e){const t={};for(let n=0,o=e.childNodes.length;n<o;n++){const o=e.childNodes[n];if(1===o.nodeType)switch(o.nodeName){case"color":const e=r(o.textContent);t.color=(new i.Color).fromArray(e).convertSRGBToLinear();break;case"falloff_angle":t.falloffAngle=parseFloat(o.textContent);break;case"quadratic_attenuation":const n=parseFloat(o.textContent);t.distance=n?Math.sqrt(1/n):0}}return t}function se(e){let t;switch(e.technique){case"directional":t=new i.DirectionalLight;break;case"point":t=new i.PointLight;break;case"spot":t=new i.SpotLight;break;case"ambient":t=new i.AmbientLight}return e.parameters.color&&t.color.copy(e.parameters.color),e.parameters.distance&&(t.distance=e.parameters.distance),t}function re(e){const t=Ye.lights[e];return void 0!==t?m(t,se):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",e),null)}function ae(e){const t={array:[],stride:3};for(let i=0;i<e.childNodes.length;i++){const s=e.childNodes[i];if(1===s.nodeType)switch(s.nodeName){case"float_array":t.array=r(s.textContent);break;case"Name_array":t.array=o(s.textContent);break;case"technique_common":const e=n(s,"accessor")[0];void 0!==e&&(t.stride=parseInt(e.getAttribute("stride")))}}return t}function ce(e){const t={};for(let n=0;n<e.childNodes.length;n++){const i=e.childNodes[n];1===i.nodeType&&(t[i.getAttribute("semantic")]=c(i.getAttribute("source")))}return t}function le(e){const t={type:e.nodeName,material:e.getAttribute("material"),count:parseInt(e.getAttribute("count")),inputs:{},stride:0,hasUV:!1};for(let n=0,i=e.childNodes.length;n<i;n++){const i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"input":const e=c(i.getAttribute("source")),n=i.getAttribute("semantic"),o=parseInt(i.getAttribute("offset")),s=parseInt(i.getAttribute("set")),r=s>0?n+s:n;t.inputs[r]={id:e,offset:o},t.stride=Math.max(t.stride,o+1),"TEXCOORD"===n&&(t.hasUV=!0);break;case"vcount":t.vcount=a(i.textContent);break;case"p":t.p=a(i.textContent)}}return t}function ue(e){let t=0;for(let n=0,i=e.length;n<i;n++){!0===e[n].hasUV&&t++}t>0&&t<e.length&&(e.uvsNeedsFix=!0)}function de(e){const t={},n=e.sources,i=e.vertices,o=e.primitives;if(0===o.length)return{};const s=function(e){const t={};for(let n=0;n<e.length;n++){const i=e[n];void 0===t[i.type]&&(t[i.type]=[]),t[i.type].push(i)}return t}(o);for(const e in s){const o=s[e];ue(o),t[e]=fe(o,n,i)}return t}function fe(e,t,n){const o={},s={array:[],stride:0},r={array:[],stride:0},a={array:[],stride:0},c={array:[],stride:0},l={array:[],stride:0},u=[],d=4,f=[],h=4,m=new i.BufferGeometry,p=[];let g=0;for(let i=0;i<e.length;i++){const o=e[i],d=o.inputs;let h=0;switch(o.type){case"lines":case"linestrips":h=2*o.count;break;case"triangles":h=3*o.count;break;case"polylist":for(let e=0;e<o.count;e++){const t=o.vcount[e];switch(t){case 3:h+=3;break;case 4:h+=6;break;default:h+=3*(t-2)}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",o.type)}m.addGroup(g,h,i),g+=h,o.material&&p.push(o.material);for(const i in d){const h=d[i];switch(i){case"VERTEX":for(const i in n){const d=n[i];switch(i){case"POSITION":const n=s.array.length;if(he(o,t[d],h.offset,s.array),s.stride=t[d].stride,t.skinWeights&&t.skinIndices&&(he(o,t.skinIndices,h.offset,u),he(o,t.skinWeights,h.offset,f)),!1===o.hasUV&&!0===e.uvsNeedsFix){const e=(s.array.length-n)/s.stride;for(let t=0;t<e;t++)a.array.push(0,0)}break;case"NORMAL":he(o,t[d],h.offset,r.array),r.stride=t[d].stride;break;case"COLOR":he(o,t[d],h.offset,l.array),l.stride=t[d].stride;break;case"TEXCOORD":he(o,t[d],h.offset,a.array),a.stride=t[d].stride;break;case"TEXCOORD1":he(o,t[d],h.offset,c.array),a.stride=t[d].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',i)}}break;case"NORMAL":he(o,t[h.id],h.offset,r.array),r.stride=t[h.id].stride;break;case"COLOR":he(o,t[h.id],h.offset,l.array,!0),l.stride=t[h.id].stride;break;case"TEXCOORD":he(o,t[h.id],h.offset,a.array),a.stride=t[h.id].stride;break;case"TEXCOORD1":he(o,t[h.id],h.offset,c.array),c.stride=t[h.id].stride}}}return s.array.length>0&&m.setAttribute("position",new i.Float32BufferAttribute(s.array,s.stride)),r.array.length>0&&m.setAttribute("normal",new i.Float32BufferAttribute(r.array,r.stride)),l.array.length>0&&m.setAttribute("color",new i.Float32BufferAttribute(l.array,l.stride)),a.array.length>0&&m.setAttribute("uv",new i.Float32BufferAttribute(a.array,a.stride)),c.array.length>0&&m.setAttribute("uv2",new i.Float32BufferAttribute(c.array,c.stride)),u.length>0&&m.setAttribute("skinIndex",new i.Float32BufferAttribute(u,d)),f.length>0&&m.setAttribute("skinWeight",new i.Float32BufferAttribute(f,h)),o.data=m,o.type=e[0].type,o.materialKeys=p,o}function he(e,t,n,i,o=!1){const s=e.p,r=e.stride,a=e.vcount;function c(e){let t=s[e+n]*u;const r=t+u;for(;t<r;t++)i.push(l[t]);if(o){const e=i.length-u-1;Xe.setRGB(i[e+0],i[e+1],i[e+2]).convertSRGBToLinear(),i[e+0]=Xe.r,i[e+1]=Xe.g,i[e+2]=Xe.b}}const l=t.array,u=t.stride;if(void 0!==e.vcount){let e=0;for(let t=0,n=a.length;t<n;t++){const n=a[t];if(4===n){const t=e+1*r,n=e+2*r,i=e+3*r;c(e+0*r),c(t),c(i),c(t),c(n),c(i)}else if(3===n){const t=e+1*r,n=e+2*r;c(e+0*r),c(t),c(n)}else if(n>4)for(let t=1,i=n-2;t<=i;t++){const n=e+r*t,i=e+r*(t+1);c(e+0*r),c(n),c(i)}e+=r*n}}else for(let e=0,t=s.length;e<t;e+=r)c(e)}function me(e){return m(Ye.geometries[e],de)}function pe(e){return void 0!==e.build?e.build:e}function ge(e,t){for(let n=0;n<e.childNodes.length;n++){const i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"joint":t.joints[i.getAttribute("sid")]=be(i);break;case"link":t.links.push(we(i))}}}function be(e){let t;for(let n=0;n<e.childNodes.length;n++){const i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"prismatic":case"revolute":t=ye(i)}}return t}function ye(e){const t={sid:e.getAttribute("sid"),name:e.getAttribute("name")||"",axis:new i.Vector3,limits:{min:0,max:0},type:e.nodeName,static:!1,zeroPosition:0,middlePosition:0};for(let n=0;n<e.childNodes.length;n++){const i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"axis":const e=r(i.textContent);t.axis.fromArray(e);break;case"limits":const n=i.getElementsByTagName("max")[0],o=i.getElementsByTagName("min")[0];t.limits.max=parseFloat(n.textContent),t.limits.min=parseFloat(o.textContent)}}return t.limits.min>=t.limits.max&&(t.static=!0),t.middlePosition=(t.limits.min+t.limits.max)/2,t}function we(e){const t={sid:e.getAttribute("sid"),name:e.getAttribute("name")||"",attachments:[],transforms:[]};for(let n=0;n<e.childNodes.length;n++){const i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"attachment_full":t.attachments.push(Ne(i));break;case"matrix":case"translate":case"rotate":t.transforms.push(xe(i))}}return t}function Ne(e){const t={joint:e.getAttribute("joint").split("/").pop(),transforms:[],links:[]};for(let n=0;n<e.childNodes.length;n++){const i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"link":t.links.push(we(i));break;case"matrix":case"translate":case"rotate":t.transforms.push(xe(i))}}return t}function xe(e){const t={type:e.nodeName},n=r(e.textContent);switch(t.type){case"matrix":t.obj=new i.Matrix4,t.obj.fromArray(n).transpose();break;case"translate":t.obj=new i.Vector3,t.obj.fromArray(n);break;case"rotate":t.obj=new i.Vector3,t.obj.fromArray(n),t.angle=i.MathUtils.degToRad(n[3])}return t}function Ae(e,t){for(let n=0;n<e.childNodes.length;n++){const i=e.childNodes[n];if(1===i.nodeType&&"technique_common"===i.nodeName)ke(i,t)}}function ke(e,t){for(let n=0;n<e.childNodes.length;n++){const i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"inertia":t.inertia=r(i.textContent);break;case"mass":t.mass=r(i.textContent)[0]}}}function Te(e){const t={target:e.getAttribute("target").split("/").pop()};for(let n=0;n<e.childNodes.length;n++){const i=e.childNodes[n];if(1===i.nodeType&&"axis"===i.nodeName){const e=i.getElementsByTagName("param")[0];t.axis=e.textContent;const n=t.axis.split("inst_").pop().split("axis")[0];t.jointIndex=n.substring(0,n.length-1)}}return t}function ve(e){return void 0!==e.build?e.build:e}function Ee(e){const t=[],n=Je.querySelector('[id="'+e.id+'"]');for(let e=0;e<n.childNodes.length;e++){const o=n.childNodes[e];if(1!==o.nodeType)continue;let s,a;switch(o.nodeName){case"matrix":s=r(o.textContent);const e=(new i.Matrix4).fromArray(s).transpose();t.push({sid:o.getAttribute("sid"),type:o.nodeName,obj:e});break;case"translate":case"scale":s=r(o.textContent),a=(new i.Vector3).fromArray(s),t.push({sid:o.getAttribute("sid"),type:o.nodeName,obj:a});break;case"rotate":s=r(o.textContent),a=(new i.Vector3).fromArray(s);const n=i.MathUtils.degToRad(s[3]);t.push({sid:o.getAttribute("sid"),type:o.nodeName,obj:a,angle:n})}}return t}const Ce=new i.Matrix4,Re=new i.Vector3;function Le(e){const t={name:e.getAttribute("name")||"",type:e.getAttribute("type"),id:e.getAttribute("id"),sid:e.getAttribute("sid"),matrix:new i.Matrix4,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}};for(let n=0;n<e.childNodes.length;n++){const o=e.childNodes[n];if(1!==o.nodeType)continue;let s;switch(o.nodeName){case"node":t.nodes.push(o.getAttribute("id")),Le(o);break;case"instance_camera":t.instanceCameras.push(c(o.getAttribute("url")));break;case"instance_controller":t.instanceControllers.push(_e(o));break;case"instance_light":t.instanceLights.push(c(o.getAttribute("url")));break;case"instance_geometry":t.instanceGeometries.push(_e(o));break;case"instance_node":t.instanceNodes.push(c(o.getAttribute("url")));break;case"matrix":s=r(o.textContent),t.matrix.multiply(Ce.fromArray(s).transpose()),t.transforms[o.getAttribute("sid")]=o.nodeName;break;case"translate":s=r(o.textContent),Re.fromArray(s),t.matrix.multiply(Ce.makeTranslation(Re.x,Re.y,Re.z)),t.transforms[o.getAttribute("sid")]=o.nodeName;break;case"rotate":s=r(o.textContent);const e=i.MathUtils.degToRad(s[3]);t.matrix.multiply(Ce.makeRotationAxis(Re.fromArray(s),e)),t.transforms[o.getAttribute("sid")]=o.nodeName;break;case"scale":s=r(o.textContent),t.matrix.scale(Re.fromArray(s)),t.transforms[o.getAttribute("sid")]=o.nodeName;break;case"extra":break;default:console.log(o)}}return Oe(t.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",t.id):Ye.nodes[t.id]=t,t}function _e(e){const t={id:c(e.getAttribute("url")),materials:{},skeletons:[]};for(let n=0;n<e.childNodes.length;n++){const i=e.childNodes[n];switch(i.nodeName){case"bind_material":const e=i.getElementsByTagName("instance_material");for(let n=0;n<e.length;n++){const i=e[n],o=i.getAttribute("symbol"),s=i.getAttribute("target");t.materials[o]=c(s)}break;case"skeleton":t.skeletons.push(c(i.textContent))}}return t}function Fe(e,t){const n=[],o=[];let s,r,a;for(s=0;s<e.length;s++){const i=e[s];let o;if(Oe(i))o=qe(i),Ue(o,t,n);else if(c=i,void 0!==Ye.visualScenes[c]){const e=Ye.visualScenes[i].children;for(let i=0;i<e.length;i++){const o=e[i];if("JOINT"===o.type){Ue(qe(o.id),t,n)}}}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",i)}var c;for(s=0;s<t.length;s++)for(r=0;r<n.length;r++)if(a=n[r],a.bone.name===t[s].name){o[s]=a,a.processed=!0;break}for(s=0;s<n.length;s++)a=n[s],!1===a.processed&&(o.push(a),a.processed=!0);const l=[],u=[];for(s=0;s<o.length;s++)a=o[s],l.push(a.bone),u.push(a.boneInverse);return new i.Skeleton(l,u)}function Ue(e,t,n){e.traverse((function(e){if(!0===e.isBone){let o;for(let n=0;n<t.length;n++){const i=t[n];if(i.name===e.name){o=i.boneInverse;break}}void 0===o&&(o=new i.Matrix4),n.push({bone:e,boneInverse:o,processed:!1})}}))}function Me(e){const t=[],n=e.matrix,o=e.nodes,s=e.type,r=e.instanceCameras,a=e.instanceControllers,c=e.instanceLights,l=e.instanceGeometries,u=e.instanceNodes;for(let e=0,n=o.length;e<n;e++)t.push(qe(o[e]));for(let e=0,n=r.length;e<n;e++){const n=ne(r[e]);null!==n&&t.push(n.clone())}for(let e=0,n=a.length;e<n;e++){const n=a[e],i=(d=n.id,m(Ye.controllers[d],M)),o=Ve(me(i.id),n.materials),s=Fe(n.skeletons,i.skin.joints);for(let e=0,n=o.length;e<n;e++){const n=o[e];n.isSkinnedMesh&&(n.bind(s,i.skin.bindMatrix),n.normalizeSkinWeights()),t.push(n)}}var d;for(let e=0,n=c.length;e<n;e++){const n=re(c[e]);null!==n&&t.push(n.clone())}for(let e=0,n=l.length;e<n;e++){const n=l[e],i=Ve(me(n.id),n.materials);for(let e=0,n=i.length;e<n;e++)t.push(i[e])}for(let e=0,n=u.length;e<n;e++)t.push(qe(u[e]).clone());let f;if(0===o.length&&1===t.length)f=t[0];else{f="JOINT"===s?new i.Bone:new i.Group;for(let e=0;e<t.length;e++)f.add(t[e])}return f.name="JOINT"===s?e.sid:e.name,f.matrix.copy(n),f.matrix.decompose(f.position,f.quaternion,f.scale),f}const je=new i.MeshBasicMaterial({color:16711935});function De(e,t){const n=[];for(let i=0,o=e.length;i<o;i++){const o=t[e[i]];void 0===o?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",e[i]),n.push(je)):n.push(K(o))}return n}function Ve(e,t){const n=[];for(const o in e){const s=e[o],r=De(s.materialKeys,t);0===r.length&&("lines"===o||"linestrips"===o?r.push(new i.LineBasicMaterial):r.push(new i.MeshPhongMaterial));const a=void 0!==s.data.attributes.skinIndex,c=1===r.length?r[0]:r;let l;switch(o){case"lines":l=new i.LineSegments(s.data,c);break;case"linestrips":l=new i.Line(s.data,c);break;case"triangles":case"polylist":l=a?new i.SkinnedMesh(s.data,c):new i.Mesh(s.data,c)}n.push(l)}return n}function Oe(e){return void 0!==Ye.nodes[e]}function qe(e){return m(Ye.nodes[e],Me)}function Se(e){const t=new i.Group;t.name=e.name;const n=e.children;for(let e=0;e<n.length;e++){const i=n[e];t.add(qe(i.id))}return t}function Ie(e){return m(Ye.visualScenes[e],Se)}if(0===e.length)return{scene:new i.Scene};const Be=(new DOMParser).parseFromString(e,"application/xml"),Je=n(Be,"COLLADA")[0],Pe=Be.getElementsByTagName("parsererror")[0];if(void 0!==Pe){const e=n(Pe,"div")[0];let t;return t=e?e.textContent:function(e){let t="";const n=[e];for(;n.length;){const e=n.shift();e.nodeType===Node.TEXT_NODE?t+=e.textContent:(t+="\n",n.push.apply(n,e.childNodes))}return t.trim()}(Pe),console.error("THREE.ColladaLoader: Failed to parse collada file.\n",t),null}const He=Je.getAttribute("version");console.log("THREE.ColladaLoader: File version",He);const Ge=(ze=n(Je,"asset")[0],{unit:u(n(ze,"unit")[0]),upAxis:d(n(ze,"up_axis")[0])});var ze;const We=new i.TextureLoader(this.manager);let Qe;We.setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin),s.TGALoader&&(Qe=new s.TGALoader(this.manager),Qe.setPath(this.resourcePath||t));const Xe=new i.Color,$e=[];let Ke={},Ze=0;const Ye={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};f(Je,"library_animations","animation",(function e(t){const n={sources:{},samplers:{},channels:{}};let o=!1;for(let i=0,s=t.childNodes.length;i<s;i++){const s=t.childNodes[i];if(1!==s.nodeType)continue;let r;switch(s.nodeName){case"source":r=s.getAttribute("id"),n.sources[r]=ae(s);break;case"sampler":r=s.getAttribute("id"),n.samplers[r]=p(s);break;case"channel":r=s.getAttribute("target"),n.channels[r]=g(s);break;case"animation":e(s),o=!0;break;default:console.log(s)}}!1===o&&(Ye.animations[t.getAttribute("id")||i.MathUtils.generateUUID()]=n)})),f(Je,"library_animation_clips","animation_clip",(function(e){const t={name:e.getAttribute("id")||"default",start:parseFloat(e.getAttribute("start")||0),end:parseFloat(e.getAttribute("end")||0),animations:[]};for(let n=0,i=e.childNodes.length;n<i;n++){const i=e.childNodes[n];if(1===i.nodeType&&"instance_animation"===i.nodeName)t.animations.push(c(i.getAttribute("url")))}Ye.clips[e.getAttribute("id")]=t})),f(Je,"library_controllers","controller",(function(e){const t={};for(let n=0,i=e.childNodes.length;n<i;n++){const i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"skin":t.id=c(i.getAttribute("source")),t.skin=_(i);break;case"morph":t.id=c(i.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.")}}Ye.controllers[e.getAttribute("id")]=t})),f(Je,"library_images","image",(function(e){const t={init_from:n(e,"init_from")[0].textContent};Ye.images[e.getAttribute("id")]=t})),f(Je,"library_effects","effect",(function(e){const t={};for(let n=0,i=e.childNodes.length;n<i;n++){const i=e.childNodes[n];if(1===i.nodeType&&"profile_COMMON"===i.nodeName)t.profile=V(i)}Ye.effects[e.getAttribute("id")]=t})),f(Je,"library_materials","material",(function(e){const t={name:e.getAttribute("name")};for(let n=0,i=e.childNodes.length;n<i;n++){const i=e.childNodes[n];if(1===i.nodeType&&"instance_effect"===i.nodeName)t.url=c(i.getAttribute("url"))}Ye.materials[e.getAttribute("id")]=t})),f(Je,"library_cameras","camera",(function(e){const t={name:e.getAttribute("name")};for(let n=0,i=e.childNodes.length;n<i;n++){const i=e.childNodes[n];if(1===i.nodeType&&"optics"===i.nodeName)t.optics=Z(i)}Ye.cameras[e.getAttribute("id")]=t})),f(Je,"library_lights","light",(function(e){let t={};for(let n=0,i=e.childNodes.length;n<i;n++){const i=e.childNodes[n];if(1===i.nodeType&&"technique_common"===i.nodeName)t=ie(i)}Ye.lights[e.getAttribute("id")]=t})),f(Je,"library_geometries","geometry",(function(e){const t={name:e.getAttribute("name"),sources:{},vertices:{},primitives:[]},i=n(e,"mesh")[0];if(void 0!==i){for(let e=0;e<i.childNodes.length;e++){const n=i.childNodes[e];if(1!==n.nodeType)continue;const o=n.getAttribute("id");switch(n.nodeName){case"source":t.sources[o]=ae(n);break;case"vertices":t.vertices=ce(n);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",n.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":t.primitives.push(le(n));break;default:console.log(n)}}Ye.geometries[e.getAttribute("id")]=t}})),f(Je,"library_nodes","node",Le),f(Je,"library_visual_scenes","visual_scene",(function(e){const t={name:e.getAttribute("name"),children:[]};!function(e){const t=e.getElementsByTagName("node");for(let e=0;e<t.length;e++){const n=t[e];!1===n.hasAttribute("id")&&n.setAttribute("id","three_default_"+Ze++)}}(e);const i=n(e,"node");for(let e=0;e<i.length;e++)t.children.push(Le(i[e]));Ye.visualScenes[e.getAttribute("id")]=t})),f(Je,"library_kinematics_models","kinematics_model",(function(e){const t={name:e.getAttribute("name")||"",joints:{},links:[]};for(let n=0;n<e.childNodes.length;n++){const i=e.childNodes[n];if(1===i.nodeType&&"technique_common"===i.nodeName)ge(i,t)}Ye.kinematicsModels[e.getAttribute("id")]=t})),f(Je,"library_physics_models","physics_model",(function(e){const t={name:e.getAttribute("name")||"",rigidBodies:{}};for(let n=0;n<e.childNodes.length;n++){const i=e.childNodes[n];if(1===i.nodeType&&"rigid_body"===i.nodeName)t.rigidBodies[i.getAttribute("name")]={},Ae(i,t.rigidBodies[i.getAttribute("name")])}Ye.physicsModels[e.getAttribute("id")]=t})),f(Je,"scene","instance_kinematics_scene",(function(e){const t={bindJointAxis:[]};for(let n=0;n<e.childNodes.length;n++){const i=e.childNodes[n];if(1===i.nodeType&&"bind_joint_axis"===i.nodeName)t.bindJointAxis.push(Te(i))}Ye.kinematicsScenes[c(e.getAttribute("url"))]=t})),h(Ye.animations,b),h(Ye.clips,R),h(Ye.controllers,M),h(Ye.images,j),h(Ye.effects,X),h(Ye.materials,$),h(Ye.cameras,te),h(Ye.lights,se),h(Ye.geometries,de),h(Ye.visualScenes,Se),function(){const e=Ye.clips;if(!0===l(e)){if(!1===l(Ye.animations)){const e=[];for(const t in Ye.animations){const n=y(t);for(let t=0,i=n.length;t<i;t++)e.push(n[t])}$e.push(new i.AnimationClip("default",-1,e))}}else for(const t in e)$e.push(L(t))}(),function(){const e=Object.keys(Ye.kinematicsModels)[0],t=Object.keys(Ye.kinematicsScenes)[0],n=Object.keys(Ye.visualScenes)[0];if(void 0===e||void 0===t)return;const o=(s=e,m(Ye.kinematicsModels[s],pe));var s;const r=function(e){return m(Ye.kinematicsScenes[e],ve)}(t),a=Ie(n),c=r.bindJointAxis,l={};for(let e=0,t=c.length;e<t;e++){const t=c[e],n=Je.querySelector('[sid="'+t.target+'"]');if(n){const e=n.parentElement;u(t.jointIndex,e)}}function u(e,t){const n=t.getAttribute("name"),i=o.joints[e];a.traverse((function(o){o.name===n&&(l[e]={object:o,transforms:Ee(t),joint:i,position:i.zeroPosition})}))}const d=new i.Matrix4;Ke={joints:o&&o.joints,getJointValue:function(e){const t=l[e];if(t)return t.position;console.warn("THREE.ColladaLoader: Joint "+e+" doesn't exist.")},setJointValue:function(e,t){const n=l[e];if(n){const o=n.joint;if(t>o.limits.max||t<o.limits.min)console.warn("THREE.ColladaLoader: Joint "+e+" value "+t+" outside of limits (min: "+o.limits.min+", max: "+o.limits.max+").");else if(o.static)console.warn("THREE.ColladaLoader: Joint "+e+" is static.");else{const s=n.object,r=o.axis,a=n.transforms;Ce.identity();for(let n=0;n<a.length;n++){const s=a[n];if(s.sid&&-1!==s.sid.indexOf(e))switch(o.type){case"revolute":Ce.multiply(d.makeRotationAxis(r,i.MathUtils.degToRad(t)));break;case"prismatic":Ce.multiply(d.makeTranslation(r.x*t,r.y*t,r.z*t));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+o.type)}else switch(s.type){case"matrix":Ce.multiply(s.obj);break;case"translate":Ce.multiply(d.makeTranslation(s.obj.x,s.obj.y,s.obj.z));break;case"scale":Ce.scale(s.obj);break;case"rotate":Ce.multiply(d.makeRotationAxis(s.obj,s.angle))}}s.matrix.copy(Ce),s.matrix.decompose(s.position,s.quaternion,s.scale),l[e].position=t}}else console.log("THREE.ColladaLoader: "+e+" does not exist.")}}}();const et=function(e){return Ie(c(n(e,"instance_visual_scene")[0].getAttribute("url")))}(n(Je,"scene")[0]);return et.animations=$e,"Z_UP"===Ge.upAxis&&et.quaternion.setFromEuler(new i.Euler(-Math.PI/2,0,0)),et.scale.multiplyScalar(Ge.unit),{get animations(){return console.warn("THREE.ColladaLoader: Please access animations over scene.animations now."),$e},kinematics:Ke,library:Ye,scene:et}}}})),o.register("iVtfO",(function(t,n){e(t.exports,"TGALoader",(()=>s));var i=o("ilwiq");class s extends i.DataTextureLoader{constructor(e){super(e)}parse(e){const t=0,n=1,o=2,s=3,r=9,a=10,c=11,l=48,u=4,d=0,f=1,h=2,m=3;e.length<19&&console.error("THREE.TGALoader: Not enough data to contain header.");let p=0;const g=new Uint8Array(e),b={id_length:g[p++],colormap_type:g[p++],image_type:g[p++],colormap_index:g[p++]|g[p++]<<8,colormap_length:g[p++]|g[p++]<<8,colormap_size:g[p++],origin:[g[p++]|g[p++]<<8,g[p++]|g[p++]<<8],width:g[p++]|g[p++]<<8,height:g[p++]|g[p++]<<8,pixel_size:g[p++],flags:g[p++]};!function(e){switch(e.image_type){case n:case r:(e.colormap_length>256||24!==e.colormap_size||1!==e.colormap_type)&&console.error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case o:case s:case a:case c:e.colormap_type&&console.error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case t:console.error("THREE.TGALoader: No data.");default:console.error('THREE.TGALoader: Invalid type "%s".',e.image_type)}(e.width<=0||e.height<=0)&&console.error("THREE.TGALoader: Invalid image size."),8!==e.pixel_size&&16!==e.pixel_size&&24!==e.pixel_size&&32!==e.pixel_size&&console.error('THREE.TGALoader: Invalid pixel size "%s".',e.pixel_size)}(b),b.id_length+p>e.length&&console.error("THREE.TGALoader: No data."),p+=b.id_length;let y=!1,w=!1,N=!1;switch(b.image_type){case r:y=!0,w=!0;break;case n:w=!0;break;case a:y=!0;break;case o:break;case c:y=!0,N=!0;break;case s:N=!0}const x=new Uint8Array(b.width*b.height*4),A=function(e,t,n,i,o){let s,r;const a=n.pixel_size>>3,c=n.width*n.height*a;if(t&&(r=o.subarray(i,i+=n.colormap_length*(n.colormap_size>>3))),e){let e,t,n;s=new Uint8Array(c);let r=0;const l=new Uint8Array(a);for(;r<c;)if(e=o[i++],t=1+(127&e),128&e){for(n=0;n<a;++n)l[n]=o[i++];for(n=0;n<t;++n)s.set(l,r+n*a);r+=a*t}else{for(t*=a,n=0;n<t;++n)s[r+n]=o[i++];r+=t}}else s=o.subarray(i,i+=t?n.width*n.height:c);return{pixel_data:s,palettes:r}}(y,w,b,p,g);return function(e,t,n,i,o){let s,r,a,c,p,g;switch((b.flags&l)>>u){default:case h:s=0,a=1,p=t,r=0,c=1,g=n;break;case d:s=0,a=1,p=t,r=n-1,c=-1,g=-1;break;case m:s=t-1,a=-1,p=-1,r=0,c=1,g=n;break;case f:s=t-1,a=-1,p=-1,r=n-1,c=-1,g=-1}if(N)switch(b.pixel_size){case 8:!function(e,t,n,i,o,s,r,a){let c,l,u,d=0;const f=b.width;for(u=t;u!==i;u+=n)for(l=o;l!==r;l+=s,d++)c=a[d],e[4*(l+f*u)+0]=c,e[4*(l+f*u)+1]=c,e[4*(l+f*u)+2]=c,e[4*(l+f*u)+3]=255}(e,r,c,g,s,a,p,i);break;case 16:!function(e,t,n,i,o,s,r,a){let c,l,u=0;const d=b.width;for(l=t;l!==i;l+=n)for(c=o;c!==r;c+=s,u+=2)e[4*(c+d*l)+0]=a[u+0],e[4*(c+d*l)+1]=a[u+0],e[4*(c+d*l)+2]=a[u+0],e[4*(c+d*l)+3]=a[u+1]}(e,r,c,g,s,a,p,i);break;default:console.error("THREE.TGALoader: Format not supported.")}else switch(b.pixel_size){case 8:!function(e,t,n,i,o,s,r,a,c){const l=c;let u,d,f,h=0;const m=b.width;for(f=t;f!==i;f+=n)for(d=o;d!==r;d+=s,h++)u=a[h],e[4*(d+m*f)+3]=255,e[4*(d+m*f)+2]=l[3*u+0],e[4*(d+m*f)+1]=l[3*u+1],e[4*(d+m*f)+0]=l[3*u+2]}(e,r,c,g,s,a,p,i,o);break;case 16:!function(e,t,n,i,o,s,r,a){let c,l,u,d=0;const f=b.width;for(u=t;u!==i;u+=n)for(l=o;l!==r;l+=s,d+=2)c=a[d+0]+(a[d+1]<<8),e[4*(l+f*u)+0]=(31744&c)>>7,e[4*(l+f*u)+1]=(992&c)>>2,e[4*(l+f*u)+2]=(31&c)<<3,e[4*(l+f*u)+3]=32768&c?0:255}(e,r,c,g,s,a,p,i);break;case 24:!function(e,t,n,i,o,s,r,a){let c,l,u=0;const d=b.width;for(l=t;l!==i;l+=n)for(c=o;c!==r;c+=s,u+=3)e[4*(c+d*l)+3]=255,e[4*(c+d*l)+2]=a[u+0],e[4*(c+d*l)+1]=a[u+1],e[4*(c+d*l)+0]=a[u+2]}(e,r,c,g,s,a,p,i);break;case 32:!function(e,t,n,i,o,s,r,a){let c,l,u=0;const d=b.width;for(l=t;l!==i;l+=n)for(c=o;c!==r;c+=s,u+=4)e[4*(c+d*l)+2]=a[u+0],e[4*(c+d*l)+1]=a[u+1],e[4*(c+d*l)+0]=a[u+2],e[4*(c+d*l)+3]=a[u+3]}(e,r,c,g,s,a,p,i);break;default:console.error("THREE.TGALoader: Format not supported.")}}(x,b.width,b.height,A.pixel_data,A.palettes),{data:x,width:b.width,height:b.height,flipY:!0,generateMipmaps:!0,minFilter:i.LinearMipmapLinearFilter}}}})),o.register("3iDF4",(function(t,n){e(t.exports,"URDFCollider",(()=>r)),e(t.exports,"URDFVisual",(()=>a)),e(t.exports,"URDFLink",(()=>c)),e(t.exports,"URDFJoint",(()=>l)),e(t.exports,"URDFMimicJoint",(()=>u)),e(t.exports,"URDFRobot",(()=>d));var i=o("ilwiq");class s extends i.Object3D{constructor(...e){super(...e),this.urdfNode=null,this.urdfName=""}copy(e,t){return super.copy(e,t),this.urdfNode=e.urdfNode,this.urdfName=e.urdfName,this}}class r extends s{constructor(...e){super(...e),this.isURDFCollider=!0,this.type="URDFCollider"}}class a extends s{constructor(...e){super(...e),this.isURDFVisual=!0,this.type="URDFVisual"}}class c extends s{constructor(...e){super(...e),this.isURDFLink=!0,this.type="URDFLink"}}class l extends s{get jointType(){return this._jointType}set jointType(e){if(this.jointType!==e)switch(this._jointType=e,this.matrixWorldNeedsUpdate=!0,e){case"fixed":this.jointValue=[];break;case"continuous":case"revolute":case"prismatic":this.jointValue=new Array(1).fill(0);break;case"planar":this.jointValue=new Array(2).fill(0);break;case"floating":this.jointValue=new Array(6).fill(0)}}get angle(){return this.jointValue[0]}constructor(...e){super(...e),this.isURDFJoint=!0,this.type="URDFJoint",this.jointValue=null,this.jointType="fixed",this.axis=null,this.limit={lower:0,upper:0},this.ignoreLimits=!1,this.origPosition=null,this.origQuaternion=null,this.mimicJoints=[]}copy(e,t){return super.copy(e,t),this.jointType=e.jointType,this.axis=e.axis?e.axis.clone():null,this.limit.lower=e.limit.lower,this.limit.upper=e.limit.upper,this.ignoreLimits=!1,this.jointValue=[...e.jointValue],this.origPosition=e.origPosition?e.origPosition.clone():null,this.origQuaternion=e.origQuaternion?e.origQuaternion.clone():null,this.mimicJoints=[...e.mimicJoints],this}setJointValue(...e){e=e.map((e=>parseFloat(e))),this.origPosition&&this.origQuaternion||(this.origPosition=this.position.clone(),this.origQuaternion=this.quaternion.clone());let t=!1;switch(this.mimicJoints.forEach((n=>{t=n.updateFromMimickedJoint(...e)||t})),this.jointType){case"fixed":return t;case"continuous":case"revolute":{let n=e[0];return null==n||n===this.jointValue[0]?t:(this.ignoreLimits||"revolute"!==this.jointType||(n=Math.min(this.limit.upper,n),n=Math.max(this.limit.lower,n)),this.quaternion.setFromAxisAngle(this.axis,n).premultiply(this.origQuaternion),this.jointValue[0]!==n?(this.jointValue[0]=n,this.matrixWorldNeedsUpdate=!0,!0):t)}case"prismatic":{let n=e[0];return null==n||n===this.jointValue[0]?t:(this.ignoreLimits||(n=Math.min(this.limit.upper,n),n=Math.max(this.limit.lower,n)),this.position.copy(this.origPosition),this.position.addScaledVector(this.axis,n),this.jointValue[0]!==n?(this.jointValue[0]=n,this.matrixWorldNeedsUpdate=!0,!0):t)}case"floating":case"planar":console.warn(`'${this.jointType}' joint not yet supported`)}return t}}class u extends l{constructor(...e){super(...e),this.type="URDFMimicJoint",this.mimicJoint=null,this.offset=0,this.multiplier=1}updateFromMimickedJoint(...e){const t=e.map((e=>e*this.multiplier+this.offset));return super.setJointValue(...t)}setJointValue(...e){return console.warn(`URDFMimicJoint: Setting the joint value of mimic joint "${this.urdfName}" will cause it to be out of sync.`),super.setJointValue(...e)}copy(e,t){return super.copy(e,t),this.mimicJoint=e.mimicJoint,this.offset=e.offset,this.multiplier=e.multiplier,this}}class d extends c{constructor(...e){super(...e),this.isURDFRobot=!0,this.urdfNode=null,this.urdfRobotNode=null,this.robotName=null,this.links=null,this.joints=null,this.colliders=null,this.visual=null,this.frames=null}copy(e,t){return super.copy(e,t),this.urdfRobotNode=e.urdfRobotNode,this.robotName=e.robotName,this.links={},this.joints={},this.colliders={},this.visual={},this.traverse((t=>{t.isURDFJoint&&t.urdfName in e.joints&&(this.joints[t.urdfName]=t),t.isURDFLink&&t.urdfName in e.links&&(this.links[t.urdfName]=t),t.isURDFCollider&&t.urdfName in e.colliders&&(this.colliders[t.urdfName]=t),t.isURDFVisual&&t.urdfName in e.visual&&(this.visual[t.urdfName]=t)})),this.frames={...this.colliders,...this.visual,...this.links,...this.joints},this}getFrame(e){return this.frames[e]}setJointValue(e,...t){const n=this.joints[e];return!!n&&n.setJointValue(...t)}setJointValues(e){let t=!1;for(const n in e){const i=e[n];t=Array.isArray(i)?this.setJointValue(n,...i)||t:this.setJointValue(n,i)||t}return t}}}));
//# sourceMappingURL=hexapod.6729373c.js.map
