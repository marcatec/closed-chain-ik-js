function t(t,e,r,n){Object.defineProperty(t,e,{get:r,set:n,enumerable:!0,configurable:!0})}var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r={},n={},s=e.parcelRequireafd0;null==s&&((s=function(t){if(t in r)return r[t].exports;if(t in n){var e=n[t];delete n[t];var s={id:t,exports:{}};return r[t]=s,e.call(s.exports,s,s.exports),s.exports}var o=new Error("Cannot find module '"+t+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(t,e){n[t]=e},e.parcelRequireafd0=s),s.register("7coGQ",(function(e,r){t(e.exports,"loadCuriosity",(()=>c)),t(e.exports,"loadStaubli",(()=>l)),t(e.exports,"loadATHLETE",(()=>f)),t(e.exports,"loadRobonaut",(()=>d));var n=s("8C12l"),o=s("4CEV9"),i=s("8FOWU"),a=s("ilwiq");s("lOFtY");var u=s("crxIg"),p=s("6yEsn");function h(t){function e(t){t.color.convertSRGBToLinear(),t.map&&(t.map.encoding=a.sRGBEncoding)}t.traverse((t=>{if(t.material){const r=t.material;Array.isArray(r)?r.forEach(e):e(r)}}))}function c(){return new Promise(((t,e)=>{const r=new u.XacroLoader;r.rospackCommands={find:t=>"curiosity_mars_rover_description"===t?"https://raw.githubusercontent.com/gkjohnson/curiosity_mars_rover-mirror/master/curiosity_mars_rover_description/":t},r.load("https://raw.githubusercontent.com/gkjohnson/curiosity_mars_rover-mirror/master/curiosity_mars_rover_description/urdf/curiosity_mars_rover.xacro",(e=>{let r,s,i;const u=new a.LoadingManager;u.onLoad=()=>{const e=[];s.traverse((t=>{(t.isLight||t.isLineSegments)&&e.push(t)})),e.forEach((t=>{t.parent.remove(t)})),h(s),t({ik:r,urdf:s,goalMap:i,helperScale:.3})};const c=new n.default(u);c.packages={curiosity_mars_rover_description:"https://raw.githubusercontent.com/gkjohnson/curiosity_mars_rover-mirror/master/curiosity_mars_rover_description/"},s=c.parse(e),s.joints.arm_03_joint.limit.upper=3*Math.PI/2,r=o.urdfRobotToIKRoot(s),r.clearDoF(),p.quat.fromEuler(r.quaternion,-90,0,0),r.position[1]-=.5,r.setMatrixNeedsUpdate(),s.setJointValue("arm_02_joint",-Math.PI/2),s.setJointValue("arm_03_joint",Math.PI),s.setJointValue("arm_04_joint",Math.PI),o.setIKFromUrdf(r,s),i=new Map;const l=r.find((t=>"arm_tools"===t.name)),f=s.links.arm_tools,d=new o.Joint;d.name=f.name,d.makeClosure(l),l.getWorldPosition(d.position),l.getWorldQuaternion(d.quaternion),d.setMatrixNeedsUpdate(),i.set(d,l)}),e)}))}function l(){return new Promise(((t,e)=>{const r=new u.XacroLoader;r.rospackCommands={find(t){switch(t){case"staubli_resources":return"https://raw.githubusercontent.com/ros-industrial/staubli/indigo-devel/staubli_resources/";case"staubli_tx2_90_support":return"https://raw.githubusercontent.com/ros-industrial/staubli_experimental/ce422fe0a54232d73cf44e2571fc7abc2f5ff9f6/staubli_tx2_90_support/";default:return t}}},r.load("https://raw.githubusercontent.com/ros-industrial/staubli_experimental/ce422fe0a54232d73cf44e2571fc7abc2f5ff9f6/staubli_tx2_90_support/urdf/tx2_90.xacro",(e=>{let r,s,i;const u=new a.LoadingManager;u.onLoad=()=>{t({ik:r,urdf:s,goalMap:i,helperScale:.3})};const h=new n.default(u);h.packages={staubli_tx2_90_support:"https://raw.githubusercontent.com/ros-industrial/staubli_experimental/ce422fe0a54232d73cf44e2571fc7abc2f5ff9f6/staubli_tx2_90_support/"},s=h.parse(e),r=o.urdfRobotToIKRoot(s),r.clearDoF(),p.quat.fromEuler(r.quaternion,-90,0,0),r.position[1]-=.5,r.setMatrixNeedsUpdate(),s.setJointValue("joint_2",Math.PI/4),s.setJointValue("joint_3",Math.PI/2),s.setJointValue("joint_5",-Math.PI/4),o.setIKFromUrdf(r,s),i=new Map;const c=r.find((t=>"tool0"===t.name)),l=s.links.tool0,f=new o.Joint;f.name=l.name,f.makeClosure(c),c.getWorldPosition(f.position),c.getWorldQuaternion(f.quaternion),f.setMatrixNeedsUpdate(),i.set(f,c)}),e)}))}function f(){return new Promise(((t,e)=>{let r,s,i;const u=new a.LoadingManager;u.onLoad=()=>{t({ik:r,urdf:s,goalMap:i})};new n.default(u).load("https://raw.githubusercontent.com/gkjohnson/urdf-loaders/master/urdf/T12/urdf/T12_flipped.URDF",(t=>{s=t,r=o.urdfRobotToIKRoot(s);const e=Math.PI/180;s.rotation.set(Math.PI/2,0,0);for(let t=1;t<=6;t++)s.joints[`HP${t}`].setJointValue(30*e),s.joints[`KP${t}`].setJointValue(90*e),s.joints[`AP${t}`].setJointValue(-30*e);o.setIKFromUrdf(r,s),i=new Map,r.traverse((t=>{if(console.log(t.name),t.isJoint)t.dofRestPose.set(t.dofValues),t.restPoseSet=!0;else if(/^Foot/.test(t.name)){const e=s.links[t.name],r=new o.Joint;r.name=e.name,r.makeClosure(t),t.getWorldPosition(r.position),t.getWorldQuaternion(r.quaternion),r.setMatrixNeedsUpdate(),i.set(r,t)}}))}),null,e)}))}function d(){return new Promise(((t,e)=>{let r,s,u;const p=new a.LoadingManager;p.onLoad=()=>{h(r),t({ik:s,urdf:r,goalMap:u,helperScale:.2})};const c=new n.default(p);c.packages={r2_description:"https://raw.githubusercontent.com/gkjohnson/nasa-urdf-robots/master/r2_description"},c.load("https://raw.githubusercontent.com/gkjohnson/nasa-urdf-robots/master/r2_description/robots/r2b.urdf",(t=>{r=t,r.rotation.set(-Math.PI/2,0,0),s=o.urdfRobotToIKRoot(r),r.joints["r2/left_leg/joint3"].setJointValue(60*i.DEG2RAD),r.joints["r2/left_leg/joint5"].setJointValue(60*i.DEG2RAD),r.joints["r2/left_arm/joint1"].setJointValue(-80*i.DEG2RAD),r.joints["r2/left_arm/joint2"].setJointValue(-100*i.DEG2RAD),r.joints["r2/left_arm/joint3"].setJointValue(-90*i.DEG2RAD),r.joints["r2/left_arm/joint4"].setJointValue(90*i.DEG2RAD),r.joints["r2/right_leg/joint3"].setJointValue(60*i.DEG2RAD),r.joints["r2/right_leg/joint5"].setJointValue(60*i.DEG2RAD),r.joints["r2/right_arm/joint1"].setJointValue(-80*i.DEG2RAD),r.joints["r2/right_arm/joint2"].setJointValue(100*i.DEG2RAD),r.joints["r2/right_arm/joint3"].setJointValue(-90*i.DEG2RAD),r.joints["r2/right_arm/joint4"].setJointValue(-90*i.DEG2RAD),o.setIKFromUrdf(s,r),u=new Map,s.traverse((t=>{if(t.isJoint)t.dofRestPose.set(t.dofValues),t.restPoseSet=!0;else if("r2/left_leg_foot"===t.name||"r2/right_leg_foot"===t.name){const e=r.links[t.name],n=new o.Joint;n.name=e.name,n.makeClosure(t),t.getWorldPosition(n.position),t.getWorldQuaternion(n.quaternion),n.setMatrixNeedsUpdate(),u.set(n,t)}}))}),null,e)}))}})),s.register("lOFtY",(function(e,r){t(e.exports,"XacroLoader",(()=>s("crxIg").XacroLoader));s("crxIg"),s("46e2R")})),s.register("crxIg",(function(e,r){t(e.exports,"XacroLoader",(()=>i));var n=s("dWajn"),o=s("46e2R");class i extends o.XacroParser{constructor(){super(),this.fetchOptions={}}load(t,e,r){const s=n.getUrlBase(t);""===this.workingPath&&(this.workingPath=s),this.getFileContents(t).then((t=>{this.parse(t,e,r)})).catch((t=>{r&&r(t)}))}parse(t,e,r){super.parse(t).then(e).catch((t=>{r&&r(t)}))}getFileContents(t){return fetch(t,this.fetchOptions).then((e=>{if(e.ok)return e.text();throw new Error(`XacroLoader: Failed to load url '${t}' with error code ${e.status} : ${e.statusText}.`)}))}}})),s.register("dWajn",(function(e,r){function n(t){const e=t.split(/[\\/]/g);return e.pop(),0===e.length?"./":e.join("/")+"/"}function s(t,e,r=[]){t.tagName===e&&r.push(t);for(let n=0,o=t.children.length;n<o;n++){s(t.children[n],e,r)}return r}function o(t,e){const r=t.cloneNode(),n=t.childNodes;for(let t=0,s=n.length;t<s;t++){const s=n[t],i=s.tagName;(!e||"xacro:property"!==i&&"xacro:macro"!==i)&&r.appendChild(o(s,e))}return r}function i(t){for(;t.length>0;){const e=t[t.length-1];if(e.nodeType===e.ELEMENT_NODE)break;t.pop()}}function a(t){return/^[()/*+\-%|&=[\]]+$/.test(t)}function u(t){return/^(('[^']*?')|("[^"]*?")|(`[^`]*?`))$/.test(t)}function p(t){return!isNaN(parseFloat(t))&&!/[^0-9.eE-]/.test(t)}function h(t){return t.replace(/(('[^']*?')|("[^"]*?")|(`[^`]*?`)|([()/*+\-%|&=[\]]+))/g,(t=>` ${t} `)).trim().split(/\s+/g)}function c(t){return t.replace(/[-+]{2,}/,(t=>{let e=!0;for(let r=0,n=t.length;r<n;r++){"-"===t[r]&&(e=!e)}return e?"+":"-"}))}t(e.exports,"getUrlBase",(()=>n)),t(e.exports,"getElementsWithName",(()=>s)),t(e.exports,"deepClone",(()=>o)),t(e.exports,"removeEndCommentsFromArray",(()=>i)),t(e.exports,"isOperator",(()=>a)),t(e.exports,"isString",(()=>u)),t(e.exports,"isNumber",(()=>p)),t(e.exports,"tokenize",(()=>h)),t(e.exports,"normalizeExpression",(()=>c)),t(e.exports,"PARENT_SCOPE",(()=>l)),t(e.exports,"mergePropertySets",(()=>f)),t(e.exports,"createNewPropertyScope",(()=>d));const l=Symbol("parent");function f(...t){const e={};for(let r=0,n=t.length;r<n;r++){const n=t[r];for(const t in n)e[t]=n[t];l in n&&(e[l]=n[l])}return e}function d(t){const e=f(t);return e[l]=t,e}})),s.register("46e2R",(function(e,r){t(e.exports,"XacroParser",(()=>i));var n=s("dWajn"),o=s("5NdfP");class i{constructor(){this.inOrder=!0,this.requirePrefix=!0,this.localProperties=!0,this.rospackCommands={},this.workingPath=""}async getFileContents(t){throw new Error("XacroParser: getFileContents() not implemented.")}async parse(t){function e(t,e,r=!1){const s=[],o=n.mergePropertySets(g,e);try{let e=function t(e,r){return"number"==typeof e?e:e.replace(/(\$?\$\([^)]+\))|(\$?\${[^}]+})/g,(e=>{if(/^\$\$/.test(e))return e;const o=/^\$\(/.test(e);let i=e.substring(2,e.length-1);if(i=t(i,r),!o){if(s.includes(i))throw new Error(`XacroParser: Cannot evaluate infinitely recursive expression: ${s.join(" > ")} > ${i}`);s.push(i);const e=/(()|()|()|[()/*+\-%|&=[\]])+/g,o=n.tokenize(i).map((s=>{if(e.lastIndex=0,n.isOperator(s))return s;if(n.isNumber(s))return s;if(n.isString(s))return s;if(s in r){const e=t(r[s],r);return n.isNumber(e)?e:`"${e.toString().replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}return s})).join("");if(s.pop(),n.isString(o))return o.substring(1,o.length-1);if(n.isNumber(o))return o;{const t=n.normalizeExpression(o);return y(t)}}{const e=t(i,r).split(/\s+/g),n=e.shift();try{return v(n,...e)}catch(t){throw new Error(`XacroParser: Cannot run rospack command "${i}".\n`+t.message)}}}))}(t,o);return r&&(e=e.replace(/\${2}([({])/g,((t,e)=>`$${e}`))),e}catch(e){throw new Error(`XacroParser: Failed to process expression "${t}". \n`+e.message)}}function r(t){const e=t.getAttribute("name").replace(/^xacro:/,""),r=t.getAttribute("params"),s={};if(r){const t=r.trim().split(/\s+/g).map((t=>function(t){const e={};if(/^\*\*/.test(t)?e.type="MULTI_BLOCK":/^\*/.test(t)?e.type="BLOCK":e.type="PARAM",t=t.replace(/^\*{1,2}/g,""),/:=/.test(t)){const[r,n]=t.split(":=");if(/^\^/.test(n)||/\|/.test(n))throw new Error(`XacroParser: ROS Jade pass-through notation not supported in macro defaults: ${n}`);e.name=r,e.def=n}else e.name=t,e.def=null;return e}(t)));t.forEach((t=>{s[t.name]=t}))}return{name:e,node:n.deepClone(t,!1),params:s}}async function s(t,o,i,u=[]){if(t.nodeType!==t.ELEMENT_NODE){const r=t.cloneNode();return r.textContent=e(r.textContent,o,!0),void u.push(r)}let p=t.tagName.toLowerCase();if(!l)switch(p){case"arg":case"property":case"macro":case"insert_block":case"if":case"unless":case"include":case"element":case"attribute":p=`xacro:${p}`;break;default:p in i&&(p=`xacro:${p}`)}switch(p){case"xacro:property":{n.removeEndCommentsFromArray(u);const r=t.getAttribute("name");let s;if(t.hasAttribute("value"))s=t.getAttribute("value");else if(t.hasAttribute("default"))s=t.getAttribute("default");else{const e=[...t.childNodes];s=[];for(const t of e)s.push(n.deepClone(t,!1))}let i="global";x&&(i=t.getAttribute("scope")||"local"),"local"!==i&&(s=e(s,o)),"global"===i?g[r]=s:"parent"===i?o[n.PARENT_SCOPE][r]=s:o[r]=s;break}case"xacro:macro":{n.removeEndCommentsFromArray(u);const e=r(t);i[e.name]=e;break}case"xacro:insert_block":{n.removeEndCommentsFromArray(u);const e=o[t.getAttribute("name")];for(const t of e)await s(t,o,i,u);return}case"xacro:if":case"xacro:unless":{n.removeEndCommentsFromArray(u);const r=e(t.getAttribute("value"),o,!0);let a=null;if(a=isNaN(parseFloat(r))?"true"===r||"false"===r?"true"===r:r:!!parseFloat(r),"xacro:unless"===p&&(a=!a),a){const e=[...t.childNodes];for(const t of e)await s(t,o,i,u)}return}case"xacro:include":{if(n.removeEndCommentsFromArray(u),t.hasAttribute("ns"))throw new Error("XacroParser: xacro:include name spaces not supported.");const r=e(t.getAttribute("filename"),o,!0),p=/^[/\\]/.test(r)||/^[a-zA-Z]+:[/\\]/.test(r)?r:w+r,h=w;w=n.getUrlBase(p);const c=[...(await a(p)).children[0].childNodes];for(const t of c)await s(t,o,i,u);return void(w=h)}case"xacro:arg":case"xacro:attribute":case"xacro:element":throw new Error(`XacroParser: ${p} tags not supported.`);default:if(/^xacro:/.test(p)||p in i)return n.removeEndCommentsFromArray(u),async function(t,r,o,i){const a=t.tagName.replace(/^xacro:/,""),u=o[a];if(!u)throw new Error(`XacroParser: Cannot find macro "${a}"`);const p=r,h=o;r=n.createNewPropertyScope(r),o=n.mergePropertySets(o);let c=[];for(const e of t.children)await s(e,p,h,c);c=c.filter((t=>t.nodeType===t.ELEMENT_NODE));let l=0;for(const n in u.params){const s=u.params[n];t.hasAttribute(n)?r[n]=e(t.getAttribute(n),p):"BLOCK"===s.type?(r[n]=[c[l]],l++):"MULTI_BLOCK"===s.type?r[n]=[...c.filter((t=>t.tagName===n))[0].childNodes]:r[n]=e(u.params[n].def,p)}const f=[...u.node.childNodes];for(const t of f){const e=[];await s(t,r,o,e),i.push(...e)}}(t,o,i,u);{const r=t.cloneNode();for(let t=0,n=r.attributes.length;t<n;t++){const n=r.attributes[t],s=e(n.value,o,!0);r.setAttribute(n.name,s)}const n=[...t.childNodes],a=[];for(let t=0,e=n.length;t<e;t++)await s(n[t],o,i,a);a.forEach((t=>r.appendChild(t))),u.push(r)}}}async function i(t,e,r){const o=n.getElementsWithName(t,"xacro:property");l||o.push(...n.getElementsWithName(t,"property"));for(const t of o)await s(t,e,r);const i=n.getElementsWithName(t,"xacro:macro");l||i.push(...n.getElementsWithName(t,"macro"));for(const t of i)await s(t,e,r)}async function a(t){try{const e=await p.getFileContents(t);return(new DOMParser).parseFromString(e,"text/xml")}catch(e){throw new Error(`XacroParser: Could not load included file: ${t}`)}}async function u(t,e,r=[]){const s=n.getElementsWithName(t,"xacro:include");l||s.push(...n.getElementsWithName(t,"include"));const o=s.map((t=>{if(t.hasAttribute("ns"))throw new Error("XacroParser: xacro:include name spaces not supported.");const s=t.getAttribute("filename"),o=t.getAttribute("ns")||null,i=/^[/\\]/.test(s)||/^[a-zA-Z]+:[/\\]/.test(s)?s:e+s;return a(i).then((t=>{r.push({filename:s,namespace:o,content:t});return u(t,n.getUrlBase(i),r)}))}));return await Promise.all(o),r}const p=this,h=this.inOrder,c=this.workingPath+(this.workingPath&&!/[\\/]$/.test(this.workingPath)?"/":""),l=this.requirePrefix,f=this.rospackCommands,d={},m={},g={True:1,False:0};g[n.PARENT_SCOPE]=g;const v=(t,...e)=>f instanceof Function?f(t,...e):f[t](...e),y=o.evaluateExpression;let x=this.localProperties,w=c,b=(new DOMParser).parseFromString(t,"text/xml");x&&!h&&(console.warn('XacroParser: Implicitly setting "localProperties" option to false because "inOrder" is false.'),x=!1);let E=null;return E=h?Promise.resolve():async function(){return await i(b,g,d),b=n.deepClone(b,!0),u(b,c).then((t=>{t.forEach((t=>{i(t.content,g,d),t.content=n.deepClone(t.content,!0),m[t.filename]=t.content}))}))}(),await E,async function(t,e,r){const n=t.cloneNode();for(let o=0,i=t.children.length;o<i;o++){const i=[];await s(t.children[o],e,r,i);const a=i[0];a.removeAttribute("xmlns:xacro"),n.appendChild(a)}return n}(b,g,d)}}})),s.register("5NdfP",(function(e,r){t(e.exports,"evaluateExpression",(()=>i));var n=s("dWajn");const o=new(s("78epA").Parser);function i(t){return o.evaluate(t)}o.unaryOps={"-":o.unaryOps["-"],"+":o.unaryOps["+"],"!":o.unaryOps["!"]},o.functions={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,log:Math.log,atan2:Math.atan2,pow:Math.pow,radians:t=>t*(Math.PI/180),degrees:t=>t*(180/Math.PI)},o.binaryOps={...o.binaryOps,"+":(t,e)=>(n.isNumber(t)&&(t=Number(t)),n.isNumber(e)&&(e=Number(e)),t+e),in:(t,e)=>Array.isArray(e)||"string"==typeof e?e.includes(t):t in e},o.consts={...o.consts,pi:Math.PI,e:Math.E}})),s.register("78epA",(function(e,r){t(e.exports,"Parser",(()=>Vt));var n="INUMBER",s="IOP1",o="IOP2",i="IOP3",a="IVAR",u="IVARNAME",p="IFUNCALL",h="IFUNDEF",c="IEXPR",l="IEXPREVAL",f="IMEMBER",d="IENDSTATEMENT",m="IARRAY";function g(t,e){this.type=t,this.value=null!=e?e:0}function v(t){return new g(s,t)}function y(t){return new g(o,t)}function x(t){return new g(i,t)}function w(t,e,r,p,h){for(var l,d,v,y,x=[],b=[],E=0;E<t.length;E++){var M=t[E],A=M.type;if(A===n||A===u)Array.isArray(M.value)?x.push.apply(x,w(M.value.map((function(t){return new g(n,t)})).concat(new g(m,M.value.length)),e,r,p,h)):x.push(M);else if(A===a&&h.hasOwnProperty(M.value))M=new g(n,h[M.value]),x.push(M);else if(A===o&&x.length>1)d=x.pop(),l=x.pop(),y=r[M.value],M=new g(n,y(l.value,d.value)),x.push(M);else if(A===i&&x.length>2)v=x.pop(),d=x.pop(),l=x.pop(),"?"===M.value?x.push(l.value?d.value:v.value):(y=p[M.value],M=new g(n,y(l.value,d.value,v.value)),x.push(M));else if(A===s&&x.length>0)l=x.pop(),y=e[M.value],M=new g(n,y(l.value)),x.push(M);else if(A===c){for(;x.length>0;)b.push(x.shift());b.push(new g(c,w(M.value,e,r,p,h)))}else if(A===f&&x.length>0)l=x.pop(),x.push(new g(n,l.value[M.value]));else{for(;x.length>0;)b.push(x.shift());b.push(M)}}for(;x.length>0;)b.push(x.shift());return b}function b(t,e,r){for(var n=[],u=0;u<t.length;u++){var p=t[u],h=p.type;if(h===a&&p.value===e)for(var l=0;l<r.tokens.length;l++){var f,d=r.tokens[l];f=d.type===s?v(d.value):d.type===o?y(d.value):d.type===i?x(d.value):new g(d.type,d.value),n.push(f)}else h===c?n.push(new g(c,b(p.value,e,r))):n.push(p)}return n}function E(t,e,r){var g,v,y,x,w,b,O=[];if(A(t))return k(t,r);for(var P=t.length,_=0;_<P;_++){var T=t[_],N=T.type;if(N===n||N===u)O.push(T.value);else if(N===o)v=O.pop(),g=O.pop(),"and"===T.value?O.push(!!g&&!!E(v,e,r)):"or"===T.value?O.push(!!g||!!E(v,e,r)):"="===T.value?(x=e.binaryOps[T.value],O.push(x(g,E(v,e,r),r))):(x=e.binaryOps[T.value],O.push(x(k(g,r),k(v,r))));else if(N===i)y=O.pop(),v=O.pop(),g=O.pop(),"?"===T.value?O.push(E(g?v:y,e,r)):(x=e.ternaryOps[T.value],O.push(x(k(g,r),k(v,r),k(y,r))));else if(N===a)if(T.value in e.functions)O.push(e.functions[T.value]);else if(T.value in e.unaryOps&&e.parser.isOperatorEnabled(T.value))O.push(e.unaryOps[T.value]);else{var C=r[T.value];if(void 0===C)throw new Error("undefined variable: "+T.value);O.push(C)}else if(N===s)g=O.pop(),x=e.unaryOps[T.value],O.push(x(k(g,r)));else if(N===p){for(b=T.value,w=[];b-- >0;)w.unshift(k(O.pop(),r));if(!(x=O.pop()).apply||!x.call)throw new Error(x+" is not a function");O.push(x.apply(void 0,w))}else if(N===h)O.push(function(){for(var t=O.pop(),n=[],s=T.value;s-- >0;)n.unshift(O.pop());var o=O.pop(),i=function(){for(var s=Object.assign({},r),o=0,i=n.length;o<i;o++)s[n[o]]=arguments[o];return E(t,e,s)};return Object.defineProperty(i,"name",{value:o,writable:!1}),r[o]=i,i}());else if(N===c)O.push(M(T,e));else if(N===l)O.push(T);else if(N===f)g=O.pop(),O.push(g[T.value]);else if(N===d)O.pop();else{if(N!==m)throw new Error("invalid Expression");for(b=T.value,w=[];b-- >0;)w.unshift(O.pop());O.push(w)}}if(O.length>1)throw new Error("invalid Expression (parity)");return 0===O[0]?0:k(O[0],r)}function M(t,e,r){return A(t)?t:{type:l,value:function(r){return E(t.value,e,r)}}}function A(t){return t&&t.type===l}function k(t,e){return A(t)?t.value(e):t}function O(t,e){for(var r,l,g,v,y,x,w=[],b=0;b<t.length;b++){var E=t[b],M=E.type;if(M===n)"number"==typeof E.value&&E.value<0?w.push("("+E.value+")"):Array.isArray(E.value)?w.push("["+E.value.map(P).join(", ")+"]"):w.push(P(E.value));else if(M===o)l=w.pop(),r=w.pop(),v=E.value,e?"^"===v?w.push("Math.pow("+r+", "+l+")"):"and"===v?w.push("(!!"+r+" && !!"+l+")"):"or"===v?w.push("(!!"+r+" || !!"+l+")"):"||"===v?w.push("(function(a,b){ return Array.isArray(a) && Array.isArray(b) ? a.concat(b) : String(a) + String(b); }(("+r+"),("+l+")))"):"=="===v?w.push("("+r+" === "+l+")"):"!="===v?w.push("("+r+" !== "+l+")"):"["===v?w.push(r+"[("+l+") | 0]"):w.push("("+r+" "+v+" "+l+")"):"["===v?w.push(r+"["+l+"]"):w.push("("+r+" "+v+" "+l+")");else if(M===i){if(g=w.pop(),l=w.pop(),r=w.pop(),"?"!==(v=E.value))throw new Error("invalid Expression");w.push("("+r+" ? "+l+" : "+g+")")}else if(M===a||M===u)w.push(E.value);else if(M===s)r=w.pop(),"-"===(v=E.value)||"+"===v?w.push("("+v+r+")"):e?"not"===v?w.push("(!"+r+")"):"!"===v?w.push("fac("+r+")"):w.push(v+"("+r+")"):"!"===v?w.push("("+r+"!)"):w.push("("+v+" "+r+")");else if(M===p){for(x=E.value,y=[];x-- >0;)y.unshift(w.pop());v=w.pop(),w.push(v+"("+y.join(", ")+")")}else if(M===h){for(l=w.pop(),x=E.value,y=[];x-- >0;)y.unshift(w.pop());r=w.pop(),e?w.push("("+r+" = function("+y.join(", ")+") { return "+l+" })"):w.push("("+r+"("+y.join(", ")+") = "+l+")")}else if(M===f)r=w.pop(),w.push(r+"."+E.value);else if(M===m){for(x=E.value,y=[];x-- >0;)y.unshift(w.pop());w.push("["+y.join(", ")+"]")}else if(M===c)w.push("("+O(E.value,e)+")");else if(M!==d)throw new Error("invalid Expression")}return w.length>1&&(w=e?[w.join(",")]:[w.join(";")]),String(w[0])}function P(t){return"string"==typeof t?JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"):t}function _(t,e){for(var r=0;r<t.length;r++)if(t[r]===e)return!0;return!1}function T(t,e,r){for(var n=!!(r=r||{}).withMembers,s=null,o=0;o<t.length;o++){var i=t[o];i.type===a||i.type===u?n||_(e,i.value)?null!==s?(_(e,s)||e.push(s),s=i.value):s=i.value:e.push(i.value):i.type===f&&n&&null!==s?s+="."+i.value:i.type===c?T(i.value,e,r):null!==s&&(_(e,s)||e.push(s),s=null)}null===s||_(e,s)||e.push(s)}function N(t,e){this.tokens=t,this.parser=e,this.unaryOps=e.unaryOps,this.binaryOps=e.binaryOps,this.ternaryOps=e.ternaryOps,this.functions=e.functions}g.prototype.toString=function(){switch(this.type){case n:case s:case o:case i:case a:case u:case d:return this.value;case p:return"CALL "+this.value;case h:return"DEF "+this.value;case m:return"ARRAY "+this.value;case f:return"."+this.value;default:return"Invalid Instruction"}},N.prototype.simplify=function(t){return t=t||{},new N(w(this.tokens,this.unaryOps,this.binaryOps,this.ternaryOps,t),this.parser)},N.prototype.substitute=function(t,e){return e instanceof N||(e=this.parser.parse(String(e))),new N(b(this.tokens,t,e),this.parser)},N.prototype.evaluate=function(t){return t=t||{},E(this.tokens,this,t)},N.prototype.toString=function(){return O(this.tokens,!1)},N.prototype.symbols=function(t){t=t||{};var e=[];return T(this.tokens,e,t),e},N.prototype.variables=function(t){t=t||{};var e=[];T(this.tokens,e,t);var r=this.functions;return e.filter((function(t){return!(t in r)}))},N.prototype.toJSFunction=function(t,e){var r=this,n=new Function(t,"with(this.functions) with (this.ternaryOps) with (this.binaryOps) with (this.unaryOps) { return "+O(this.simplify(e).tokens,!0)+"; }");return function(){return n.apply(r,arguments)}};var C="TEOF",j="TOP",I="TNUMBER",F="TSTRING",S="TPAREN",R="TBRACKET",L="TCOMMA",D="TNAME",$="TSEMICOLON";function U(t,e,r){this.type=t,this.value=e,this.index=r}function V(t,e){this.pos=0,this.current=null,this.unaryOps=t.unaryOps,this.binaryOps=t.binaryOps,this.ternaryOps=t.ternaryOps,this.consts=t.consts,this.expression=e,this.savedPosition=0,this.savedCurrent=null,this.options=t.options,this.parser=t}U.prototype.toString=function(){return this.type+": "+this.value},V.prototype.newToken=function(t,e,r){return new U(t,e,null!=r?r:this.pos)},V.prototype.save=function(){this.savedPosition=this.pos,this.savedCurrent=this.current},V.prototype.restore=function(){this.pos=this.savedPosition,this.current=this.savedCurrent},V.prototype.next=function(){return this.pos>=this.expression.length?this.newToken(C,"EOF"):this.isWhitespace()||this.isComment()?this.next():this.isRadixInteger()||this.isNumber()||this.isOperator()||this.isString()||this.isParen()||this.isBracket()||this.isComma()||this.isSemicolon()||this.isNamedOp()||this.isConst()||this.isName()?this.current:void this.parseError('Unknown character "'+this.expression.charAt(this.pos)+'"')},V.prototype.isString=function(){var t=!1,e=this.pos,r=this.expression.charAt(e);if("'"===r||'"'===r)for(var n=this.expression.indexOf(r,e+1);n>=0&&this.pos<this.expression.length;){if(this.pos=n+1,"\\"!==this.expression.charAt(n-1)){var s=this.expression.substring(e+1,n);this.current=this.newToken(F,this.unescape(s),e),t=!0;break}n=this.expression.indexOf(r,n+1)}return t},V.prototype.isParen=function(){var t=this.expression.charAt(this.pos);return("("===t||")"===t)&&(this.current=this.newToken(S,t),this.pos++,!0)},V.prototype.isBracket=function(){var t=this.expression.charAt(this.pos);return!("["!==t&&"]"!==t||!this.isOperatorEnabled("["))&&(this.current=this.newToken(R,t),this.pos++,!0)},V.prototype.isComma=function(){return","===this.expression.charAt(this.pos)&&(this.current=this.newToken(L,","),this.pos++,!0)},V.prototype.isSemicolon=function(){return";"===this.expression.charAt(this.pos)&&(this.current=this.newToken($,";"),this.pos++,!0)},V.prototype.isConst=function(){for(var t=this.pos,e=t;e<this.expression.length;e++){var r=this.expression.charAt(e);if(r.toUpperCase()===r.toLowerCase()&&(e===this.pos||"_"!==r&&"."!==r&&(r<"0"||r>"9")))break}if(e>t){var n=this.expression.substring(t,e);if(n in this.consts)return this.current=this.newToken(I,this.consts[n]),this.pos+=n.length,!0}return!1},V.prototype.isNamedOp=function(){for(var t=this.pos,e=t;e<this.expression.length;e++){var r=this.expression.charAt(e);if(r.toUpperCase()===r.toLowerCase()&&(e===this.pos||"_"!==r&&(r<"0"||r>"9")))break}if(e>t){var n=this.expression.substring(t,e);if(this.isOperatorEnabled(n)&&(n in this.binaryOps||n in this.unaryOps||n in this.ternaryOps))return this.current=this.newToken(j,n),this.pos+=n.length,!0}return!1},V.prototype.isName=function(){for(var t=this.pos,e=t,r=!1;e<this.expression.length;e++){var n=this.expression.charAt(e);if(n.toUpperCase()===n.toLowerCase()){if(e===this.pos&&("$"===n||"_"===n)){"_"===n&&(r=!0);continue}if(e===this.pos||!r||"_"!==n&&(n<"0"||n>"9"))break}else r=!0}if(r){var s=this.expression.substring(t,e);return this.current=this.newToken(D,s),this.pos+=s.length,!0}return!1},V.prototype.isWhitespace=function(){for(var t=!1,e=this.expression.charAt(this.pos);!(" "!==e&&"\t"!==e&&"\n"!==e&&"\r"!==e||(t=!0,this.pos++,this.pos>=this.expression.length));)e=this.expression.charAt(this.pos);return t};var J=/^[0-9a-f]{4}$/i;function q(t,e,r){this.parser=t,this.tokens=e,this.current=null,this.nextToken=null,this.next(),this.savedCurrent=null,this.savedNextToken=null,this.allowMemberAccess=!1!==r.allowMemberAccess}V.prototype.unescape=function(t){var e=t.indexOf("\\");if(e<0)return t;for(var r=t.substring(0,e);e>=0;){var n=t.charAt(++e);switch(n){case"'":r+="'";break;case'"':r+='"';break;case"\\":r+="\\";break;case"/":r+="/";break;case"b":r+="\b";break;case"f":r+="\f";break;case"n":r+="\n";break;case"r":r+="\r";break;case"t":r+="\t";break;case"u":var s=t.substring(e+1,e+5);J.test(s)||this.parseError("Illegal escape sequence: \\u"+s),r+=String.fromCharCode(parseInt(s,16)),e+=4;break;default:throw this.parseError('Illegal escape sequence: "\\'+n+'"')}++e;var o=t.indexOf("\\",e);r+=t.substring(e,o<0?t.length:o),e=o}return r},V.prototype.isComment=function(){return"/"===this.expression.charAt(this.pos)&&"*"===this.expression.charAt(this.pos+1)&&(this.pos=this.expression.indexOf("*/",this.pos)+2,1===this.pos&&(this.pos=this.expression.length),!0)},V.prototype.isRadixInteger=function(){var t,e,r=this.pos;if(r>=this.expression.length-2||"0"!==this.expression.charAt(r))return!1;if(++r,"x"===this.expression.charAt(r))t=16,e=/^[0-9a-f]$/i,++r;else{if("b"!==this.expression.charAt(r))return!1;t=2,e=/^[01]$/i,++r}for(var n=!1,s=r;r<this.expression.length;){var o=this.expression.charAt(r);if(!e.test(o))break;r++,n=!0}return n&&(this.current=this.newToken(I,parseInt(this.expression.substring(s,r),t)),this.pos=r),n},V.prototype.isNumber=function(){for(var t,e=!1,r=this.pos,n=r,s=r,o=!1,i=!1;r<this.expression.length&&((t=this.expression.charAt(r))>="0"&&t<="9"||!o&&"."===t);)"."===t?o=!0:i=!0,r++,e=i;if(e&&(s=r),"e"===t||"E"===t){r++;for(var a=!0,u=!1;r<this.expression.length;){if(t=this.expression.charAt(r),!a||"+"!==t&&"-"!==t){if(!(t>="0"&&t<="9"))break;u=!0,a=!1}else a=!1;r++}u||(r=s)}return e?(this.current=this.newToken(I,parseFloat(this.expression.substring(n,r))),this.pos=r):this.pos=s,e},V.prototype.isOperator=function(){var t=this.pos,e=this.expression.charAt(this.pos);if("+"===e||"-"===e||"*"===e||"/"===e||"%"===e||"^"===e||"?"===e||":"===e||"."===e)this.current=this.newToken(j,e);else if("∙"===e||"•"===e)this.current=this.newToken(j,"*");else if(">"===e)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(j,">="),this.pos++):this.current=this.newToken(j,">");else if("<"===e)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(j,"<="),this.pos++):this.current=this.newToken(j,"<");else if("|"===e){if("|"!==this.expression.charAt(this.pos+1))return!1;this.current=this.newToken(j,"||"),this.pos++}else if("="===e)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(j,"=="),this.pos++):this.current=this.newToken(j,e);else{if("!"!==e)return!1;"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(j,"!="),this.pos++):this.current=this.newToken(j,e)}return this.pos++,!!this.isOperatorEnabled(this.current.value)||(this.pos=t,!1)},V.prototype.isOperatorEnabled=function(t){return this.parser.isOperatorEnabled(t)},V.prototype.getCoordinates=function(){var t,e=0,r=-1;do{e++,t=this.pos-r,r=this.expression.indexOf("\n",r+1)}while(r>=0&&r<this.pos);return{line:e,column:t}},V.prototype.parseError=function(t){var e=this.getCoordinates();throw new Error("parse error ["+e.line+":"+e.column+"]: "+t)},q.prototype.next=function(){return this.current=this.nextToken,this.nextToken=this.tokens.next()},q.prototype.tokenMatches=function(t,e){return void 0===e||(Array.isArray(e)?_(e,t.value):"function"==typeof e?e(t):t.value===e)},q.prototype.save=function(){this.savedCurrent=this.current,this.savedNextToken=this.nextToken,this.tokens.save()},q.prototype.restore=function(){this.tokens.restore(),this.current=this.savedCurrent,this.nextToken=this.savedNextToken},q.prototype.accept=function(t,e){return!(this.nextToken.type!==t||!this.tokenMatches(this.nextToken,e))&&(this.next(),!0)},q.prototype.expect=function(t,e){if(!this.accept(t,e)){var r=this.tokens.getCoordinates();throw new Error("parse error ["+r.line+":"+r.column+"]: Expected "+(e||t))}},q.prototype.parseAtom=function(t){var e=this.tokens.unaryOps;if(this.accept(D)||this.accept(j,(function(t){return t.value in e})))t.push(new g(a,this.current.value));else if(this.accept(I))t.push(new g(n,this.current.value));else if(this.accept(F))t.push(new g(n,this.current.value));else if(this.accept(S,"("))this.parseExpression(t),this.expect(S,")");else{if(!this.accept(R,"["))throw new Error("unexpected "+this.nextToken);if(this.accept(R,"]"))t.push(new g(m,0));else{var r=this.parseArrayList(t);t.push(new g(m,r))}}},q.prototype.parseExpression=function(t){var e=[];this.parseUntilEndStatement(t,e)||(this.parseVariableAssignmentExpression(e),this.parseUntilEndStatement(t,e)||this.pushExpression(t,e))},q.prototype.pushExpression=function(t,e){for(var r=0,n=e.length;r<n;r++)t.push(e[r])},q.prototype.parseUntilEndStatement=function(t,e){return!!this.accept($)&&(!this.nextToken||this.nextToken.type===C||this.nextToken.type===S&&")"===this.nextToken.value||e.push(new g(d)),this.nextToken.type!==C&&this.parseExpression(e),t.push(new g(c,e)),!0)},q.prototype.parseArrayList=function(t){for(var e=0;!this.accept(R,"]");)for(this.parseExpression(t),++e;this.accept(L);)this.parseExpression(t),++e;return e},q.prototype.parseVariableAssignmentExpression=function(t){for(this.parseConditionalExpression(t);this.accept(j,"=");){var e=t.pop(),r=[],n=t.length-1;if(e.type!==p){if(e.type!==a&&e.type!==f)throw new Error("expected variable for assignment");this.parseVariableAssignmentExpression(r),t.push(new g(u,e.value)),t.push(new g(c,r)),t.push(y("="))}else{if(!this.tokens.isOperatorEnabled("()="))throw new Error("function definition is not permitted");for(var s=0,o=e.value+1;s<o;s++){var i=n-s;t[i].type===a&&(t[i]=new g(u,t[i].value))}this.parseVariableAssignmentExpression(r),t.push(new g(c,r)),t.push(new g(h,e.value))}}},q.prototype.parseConditionalExpression=function(t){for(this.parseOrExpression(t);this.accept(j,"?");){var e=[],r=[];this.parseConditionalExpression(e),this.expect(j,":"),this.parseConditionalExpression(r),t.push(new g(c,e)),t.push(new g(c,r)),t.push(x("?"))}},q.prototype.parseOrExpression=function(t){for(this.parseAndExpression(t);this.accept(j,"or");){var e=[];this.parseAndExpression(e),t.push(new g(c,e)),t.push(y("or"))}},q.prototype.parseAndExpression=function(t){for(this.parseComparison(t);this.accept(j,"and");){var e=[];this.parseComparison(e),t.push(new g(c,e)),t.push(y("and"))}};var W=["==","!=","<","<=",">=",">","in"];q.prototype.parseComparison=function(t){for(this.parseAddSub(t);this.accept(j,W);){var e=this.current;this.parseAddSub(t),t.push(y(e.value))}};var X=["+","-","||"];q.prototype.parseAddSub=function(t){for(this.parseTerm(t);this.accept(j,X);){var e=this.current;this.parseTerm(t),t.push(y(e.value))}};var B=["*","/","%"];function G(t,e){return Number(t)+Number(e)}function K(t,e){return t-e}function z(t,e){return t*e}function Q(t,e){return t/e}function Y(t,e){return t%e}function H(t,e){return Array.isArray(t)&&Array.isArray(e)?t.concat(e):""+t+e}function Z(t,e){return t===e}function tt(t,e){return t!==e}function et(t,e){return t>e}function rt(t,e){return t<e}function nt(t,e){return t>=e}function st(t,e){return t<=e}function ot(t,e){return Boolean(t&&e)}function it(t,e){return Boolean(t||e)}function at(t,e){return _(e,t)}function ut(t){return(Math.exp(t)-Math.exp(-t))/2}function pt(t){return(Math.exp(t)+Math.exp(-t))/2}function ht(t){return t===1/0?1:t===-1/0?-1:(Math.exp(t)-Math.exp(-t))/(Math.exp(t)+Math.exp(-t))}function ct(t){return t===-1/0?t:Math.log(t+Math.sqrt(t*t+1))}function lt(t){return Math.log(t+Math.sqrt(t*t-1))}function ft(t){return Math.log((1+t)/(1-t))/2}function dt(t){return Math.log(t)*Math.LOG10E}function mt(t){return-t}function gt(t){return!t}function vt(t){return t<0?Math.ceil(t):Math.floor(t)}function yt(t){return Math.random()*(t||1)}function xt(t){return bt(t+1)}q.prototype.parseTerm=function(t){for(this.parseFactor(t);this.accept(j,B);){var e=this.current;this.parseFactor(t),t.push(y(e.value))}},q.prototype.parseFactor=function(t){var e=this.tokens.unaryOps;if(this.save(),this.accept(j,(function(t){return t.value in e}))){if("-"!==this.current.value&&"+"!==this.current.value){if(this.nextToken.type===S&&"("===this.nextToken.value)return this.restore(),void this.parseExponential(t);if(this.nextToken.type===$||this.nextToken.type===L||this.nextToken.type===C||this.nextToken.type===S&&")"===this.nextToken.value)return this.restore(),void this.parseAtom(t)}var r=this.current;this.parseFactor(t),t.push(v(r.value))}else this.parseExponential(t)},q.prototype.parseExponential=function(t){for(this.parsePostfixExpression(t);this.accept(j,"^");)this.parseFactor(t),t.push(y("^"))},q.prototype.parsePostfixExpression=function(t){for(this.parseFunctionCall(t);this.accept(j,"!");)t.push(v("!"))},q.prototype.parseFunctionCall=function(t){var e=this.tokens.unaryOps;if(this.accept(j,(function(t){return t.value in e}))){var r=this.current;this.parseAtom(t),t.push(v(r.value))}else for(this.parseMemberExpression(t);this.accept(S,"(");)if(this.accept(S,")"))t.push(new g(p,0));else{var n=this.parseArgumentList(t);t.push(new g(p,n))}},q.prototype.parseArgumentList=function(t){for(var e=0;!this.accept(S,")");)for(this.parseExpression(t),++e;this.accept(L);)this.parseExpression(t),++e;return e},q.prototype.parseMemberExpression=function(t){for(this.parseAtom(t);this.accept(j,".")||this.accept(R,"[");){var e=this.current;if("."===e.value){if(!this.allowMemberAccess)throw new Error('unexpected ".", member access is not permitted');this.expect(D),t.push(new g(f,this.current.value))}else{if("["!==e.value)throw new Error("unexpected symbol: "+e.value);if(!this.tokens.isOperatorEnabled("["))throw new Error('unexpected "[]", arrays are disabled');this.parseExpression(t),this.expect(R,"]"),t.push(y("["))}}};var wt=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];function bt(t){var e,r;if(function(t){return isFinite(t)&&t===Math.round(t)}(t)){if(t<=0)return isFinite(t)?1/0:NaN;if(t>171)return 1/0;for(var n=t-2,s=t-1;n>1;)s*=n,n--;return 0===s&&(s=1),s}if(t<.5)return Math.PI/(Math.sin(Math.PI*t)*bt(1-t));if(t>=171.35)return 1/0;if(t>85){var o=t*t,i=o*t,a=i*t,u=a*t;return Math.sqrt(2*Math.PI/t)*Math.pow(t/Math.E,t)*(1+1/(12*t)+1/(288*o)-139/(51840*i)-571/(2488320*a)+163879/(209018880*u)+5246819/(75246796800*u*t))}--t,r=wt[0];for(var p=1;p<wt.length;++p)r+=wt[p]/(t+p);return e=t+4.7421875+.5,Math.sqrt(2*Math.PI)*Math.pow(e,t+.5)*Math.exp(-e)*r}function Et(t){return Array.isArray(t)?t.length:String(t).length}function Mt(){for(var t=0,e=0,r=0;r<arguments.length;r++){var n,s=Math.abs(arguments[r]);e<s?(t=t*(n=e/s)*n+1,e=s):t+=s>0?(n=s/e)*n:s}return e===1/0?1/0:e*Math.sqrt(t)}function At(t,e,r){return t?e:r}function kt(t,e){return void 0===e||0==+e?Math.round(t):(t=+t,e=-+e,isNaN(t)||"number"!=typeof e||e%1!=0?NaN:(t=t.toString().split("e"),+((t=(t=Math.round(+(t[0]+"e"+(t[1]?+t[1]-e:-e)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+e:e))))}function Ot(t,e,r){return r&&(r[t]=e),e}function Pt(t,e){return t[0|e]}function _t(t){return 1===arguments.length&&Array.isArray(t)?Math.max.apply(Math,t):Math.max.apply(Math,arguments)}function Tt(t){return 1===arguments.length&&Array.isArray(t)?Math.min.apply(Math,t):Math.min.apply(Math,arguments)}function Nt(t,e){if("function"!=typeof t)throw new Error("First argument to map is not a function");if(!Array.isArray(e))throw new Error("Second argument to map is not an array");return e.map((function(e,r){return t(e,r)}))}function Ct(t,e,r){if("function"!=typeof t)throw new Error("First argument to fold is not a function");if(!Array.isArray(r))throw new Error("Second argument to fold is not an array");return r.reduce((function(e,r,n){return t(e,r,n)}),e)}function jt(t,e){if("function"!=typeof t)throw new Error("First argument to filter is not a function");if(!Array.isArray(e))throw new Error("Second argument to filter is not an array");return e.filter((function(e,r){return t(e,r)}))}function It(t,e){if(!Array.isArray(e)&&"string"!=typeof e)throw new Error("Second argument to indexOf is not a string or array");return e.indexOf(t)}function Ft(t,e){if(!Array.isArray(e))throw new Error("Second argument to join is not an array");return e.join(t)}function St(t){return(t>0)-(t<0)||+t}var Rt=1/3;function Lt(t){return t<0?-Math.pow(-t,Rt):Math.pow(t,Rt)}function Dt(t){return Math.exp(t)-1}function $t(t){return Math.log(1+t)}function Ut(t){return Math.log(t)/Math.LN2}function Vt(t){this.options=t||{},this.unaryOps={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:Math.sinh||ut,cosh:Math.cosh||pt,tanh:Math.tanh||ht,asinh:Math.asinh||ct,acosh:Math.acosh||lt,atanh:Math.atanh||ft,sqrt:Math.sqrt,cbrt:Math.cbrt||Lt,log:Math.log,log2:Math.log2||Ut,ln:Math.log,lg:Math.log10||dt,log10:Math.log10||dt,expm1:Math.expm1||Dt,log1p:Math.log1p||$t,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,trunc:Math.trunc||vt,"-":mt,"+":Number,exp:Math.exp,not:gt,length:Et,"!":xt,sign:Math.sign||St},this.binaryOps={"+":G,"-":K,"*":z,"/":Q,"%":Y,"^":Math.pow,"||":H,"==":Z,"!=":tt,">":et,"<":rt,">=":nt,"<=":st,and:ot,or:it,in:at,"=":Ot,"[":Pt},this.ternaryOps={"?":At},this.functions={random:yt,fac:xt,min:Tt,max:_t,hypot:Math.hypot||Mt,pyt:Math.hypot||Mt,pow:Math.pow,atan2:Math.atan2,if:At,gamma:bt,roundTo:kt,map:Nt,fold:Ct,filter:jt,indexOf:It,join:Ft},this.consts={E:Math.E,PI:Math.PI,true:!0,false:!1}}Vt.prototype.parse=function(t){var e=[],r=new q(this,new V(this,t),{allowMemberAccess:this.options.allowMemberAccess});return r.parseExpression(e),r.expect(C,"EOF"),new N(e,this)},Vt.prototype.evaluate=function(t,e){return this.parse(t).evaluate(e)};var Jt=new Vt;Vt.parse=function(t){return Jt.parse(t)},Vt.evaluate=function(t,e){return Jt.parse(t).evaluate(e)};var qt={"+":"add","-":"subtract","*":"multiply","/":"divide","%":"remainder","^":"power","!":"factorial","<":"comparison",">":"comparison","<=":"comparison",">=":"comparison","==":"comparison","!=":"comparison","||":"concatenate",and:"logical",or:"logical",not:"logical","?":"conditional",":":"conditional","=":"assignment","[":"array","()=":"fndef"};Vt.prototype.isOperatorEnabled=function(t){var e=function(t){return qt.hasOwnProperty(t)?qt[t]:t}(t),r=this.options.operators||{};return!(e in r)||!!r[e]}}));
//# sourceMappingURL=index.3b69dfe7.js.map
